<ui:composition xmlns="http://www.w3.org/1999/xhtml"
            	 xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:jsf="http://xmlns.jcp.org/jsf"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:p="http://primefaces.org/ui"
				xmlns:ibg="http://java.sun.com/jsf/composite/components"
                template="/template/template.xhtml">
                
        <ui:define name="metadata">
			<f:metadata>
			   <f:importConstants type="com.ib.omb.system.OmbConstants" />
			</f:metadata>
		</ui:define> 
		
	<ui:define name="title">#{navTexts['/pages/opisBezZachDeloPrepList.xhtml']}</ui:define>

	<ui:define name="viewname">
	    
		<li>#{navTexts['/pages/opisBezZachDeloPrepList.xhtml']}</li>
	</ui:define>
		
	
    <ui:define name="content">


     <h:form id="formOpisiBezPrep">
		   

	<!--    <div class="container #{guestPreferences.containerPosition}">     -->
			          <div  class="p-grid" >
							  <div class="p-col-4 p-sm-4 p-md-4 p-lg-4 p-xl-4  ui-fluid" >
							         <span style="padding-left:10px"></span>
							  </div>
							  <div class="p-col-7 p-sm-7 p-md-7 p-lg-7 p-xl-7  ui-fluid" >
							  
							        <h:outputLabel value="#{labels['opis.raznBezDelo']}" style="font-weight:bold;"  />
							        
							  </div>
					  </div>	
			
				
			       <!--  Главни 2 бутона - търсене (поредно търсене за нови предадени) и изчистване за целия екран - на филтри и всички намерени предадени дела/преписки  -->
			  <!--  *******************************************************************************************************************`***************************** --> 
				<h:panelGroup id="panelAllDocs"  style="width:95%">

					<!-- <div class="card">   -->
					   <div class="p-grid">
					  						   						   
							 <div class="p-col-6 p-sm-6 p-md-6 p-lg-6 p-xl-6  ui-fluid" style="text-align: right;">
							        <h:outputLabel value="#{labels['opis.helpForIzbDela']}" style="color:blue"  />
							 </div>
						
						
						  <div class="p-col-3 p-sm-3 p-md-3 p-lg-3 p-xl-3 ui-fluid" style="text-align: right;">
							  
		                        <p:commandButton icon="fas fa-search" value="#{labels['opis.searchPredDelaPrep']}" 
												id="btnOpenSearchDoc" update="formOpisiBezPrep" partialSubmit="true"
												process="@this formOpisiBezPrep" actionListener="#{opisBezZachDeloPrepList.actionSelDocs}"
												style="width:98%;"  />   <!--  title="#{ui_labels['general.titleSearch']}" -->
		
								 
		                       
		                    </div>
		                     <div class="p-col-3 p-sm-3 p-md-3 p-lg-3 p-xl-3 ui-fluid" style="text-align: left;">    
								<p:commandButton icon="fas fa-eraser" value="#{labels['opis.clearAll']}" rendered="#{opisBezZachDeloPrepList.delaSelList != null and opisBezZachDeloPrepList.delaSelList.rowCount > 0}"
												 id="btnClearAll"   partialSubmit="true" process="@this" update="formOpisiBezPrep"
												  actionListener="#{opisBezZachDeloPrepList.actionClearAll}"
												 styleClass="ui-button-warning" style="width:80%;" />   <!--   -->
		                      </div>
	                     								
						</div>
	
				<!--  	</div> -->
				
				</h:panelGroup>
				 <!--  ******************************************************************************************************************* --> 
        	 	
        	 	<!--   Основна таблица със събрани  предадени дела/преписки на основния екран -->
        	 	 <!--  ******************************************************************************************************************* --> 		
			  <h:panelGroup id="panelTable" layout="block"  styleClass="margin-top"   rendered="#{opisBezZachDeloPrepList.delaSelList != null}"   >   <!-- rendered="#{opisBezZachDeloPrepList.delaSelList != null}"  -->
				   <h:panelGroup id="panelTableToolbar">
				         <div  class="p-grid" >
							  <div class="p-col-3 p-sm-3 p-md-3 p-lg-3 p-xl-3  ui-fluid" >
							         <span style="padding-left:10px"></span>
							  </div>
							  <div class="p-col-8 p-sm-8 p-md-8 p-lg-8 p-xl-8  ui-fluid" >
							        <h:outputLabel value="#{labels['opis.formOpisDela']}" style="font-weight:bold;" />
							  </div>
					  	</div>	
					
						<div  class="p-grid" >
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid">
								<h:outputText value="#{ui_labels['general.reportResult']} #{opisBezZachDeloPrepList.delaSelList.rowCount}" styleClass="form-label" rendered="#{opisBezZachDeloPrepList.delaSelList != null}"/>
								<h:outputText value="#{ui_labels['general.reportResult']} 0 " styleClass="form-label" rendered="#{opisBezZachDeloPrepList.delaSelList == null}"/>
							</div>
							
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							   <h:panelGroup   rendered="#{opisBezZachDeloPrepList.docSelectedAllM.size() > 0}">
									<span style="padding-right: 5px;" >
										<span class="fas fa-ellipsis-v" />
									</span>
								
									<h:outputText value="#{labels['opis.brIzbr']} #{opisBezZachDeloPrepList.docSelectedAllM.size()}"  styleClass="form-label" id="brSel"/>
								</h:panelGroup>
							</div>		
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							 <h:panelGroup   rendered="#{opisBezZachDeloPrepList.docSelectedAllM.size() > 0}">
							   <p:commandButton icon="fas fa-eraser" value="#{labels['opis.razmAll']}" 
									 update="formOpisiBezPrep " partialSubmit="true"   style="font-size:10pt;width:92%"
									process="@this panelFilter panelTable" actionListener="#{opisBezZachDeloPrepList.actionRazm}"
									styleClass="ui-button-warning"  />
							  </h:panelGroup>		
						    </div>	
						   <div class="p-col-4 p-sm-4 p-md-4 p-lg-4 p-xl-4  ui-fluid" >
						      <h:outputText value="" />
						   </div>		  
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							 <h:panelGroup   rendered="#{opisBezZachDeloPrepList.docSelectedAllM.size() > 0}" style="text-align: center;" >
							   <p:commandButton icon="fas fa-search" value="#{labels['opis.bezZach']}" 
									 update="formOpisiBezPrep " partialSubmit="true"   style="font-size:10pt;width:90%"
									process="@this panelFilter panelTable" actionListener="#{opisBezZachDeloPrepList.actionIzbrForOpis}"
									styleClass="ui-button-success"  />
							 
							  </h:panelGroup>		
						    </div>			
							
							
						</div>
						</h:panelGroup>
										                                                       <!-- #{ui_labels['general.norows']} --> 
				       	<p:dataTable id="tblDocsOpisList" var="row" value="#{opisBezZachDeloPrepList.delaSelList}" lazy="true"  widgetVar="rowS"
						rowIndexVar="idx" emptyMessage="#{labels['opis.noPredDela']}" rows="10" sortMode="single" reflow="true"
						paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
						 paginatorPosition="bottom" paginatorAlwaysVisible="true" paginator="true"
                          rowsPerPageTemplate="5,10,15,20,25"    rowSelectMode="checkbox"   selection="#{opisBezZachDeloPrepList.docSelectedTmp}"  >

						<p:ajax event="toggleSelect"	 	 listener="#{opisBezZachDeloPrepList.onRowSelectAll}" process="@this" update="@form:panelTableToolbar"/>
												
						<p:ajax event="rowSelectCheckbox"	 listener="#{opisBezZachDeloPrepList.onRowSelect}"   process="@this" update="@form:panelTableToolbar" />
						<p:ajax event="rowUnselectCheckbox"  listener="#{opisBezZachDeloPrepList.onRowUnselect}" process="@this" update="@form:panelTableToolbar" />
						<p:ajax event="page" listener="#{opisBezZachDeloPrepList.onPageUpdateSelected}"   />
		
						
						<f:facet name="{Exporters}">

							<div style="float: left">

								<h:commandLink id="excel">
									<h:graphicImage library="images" name="excel2.png" />
									
								  <p:dataExporter type="xls" target="tblDocsOpisList" fileName="opisBezZachDeloPrepListXls"  postProcessor="#{opisBezZachDeloPrepList.postProcessXLS}" />  
								</h:commandLink>   
<ui:remove><!-- 
								<h:commandLink id="pdf">
									<h:graphicImage library="images" name="pdf.png" />
									<p:dataExporter type="pdf" target="tblDocsOpisList" fileName="opisBezZachDeloPrepListPdf"  encoding="windows-1251"
					        			 preProcessor="#{opisBezZachDeloPrepList.preProcessPDF}" options="#{opisBezZachDeloPrepList.pdfOptions()}"/>	
								</h:commandLink>    

								<h:commandLink id="csv">
									<h:graphicImage library="images" name="csv.png" />
									<p:dataExporter type="csv" target="tblDocsOpisList" fileName="opisBezZachDeloPrepListCsv" encoding="CP1251" />
								</h:commandLink>
 --></ui:remove>
							</div>

						</f:facet>    
			
						
						<p:column selectionMode="multiple" exportable="false"  style="width:15px;text-align:center;"    rendered="#{!opisBezZachDeloPrepList.getVisCheck(row[0])}"/>	
						<p:column  exportable="false"  style="width:15px;text-align:center;"   rendered="#{opisBezZachDeloPrepList.getVisCheck(row[0])}" >    <!-- Тази колона замества първата, когато е забранено маркирането -->
							<h:outputText value=" "/>    
						</p:column>
						
						<p:column width="25" exportable="false" headerText="#{ui_labels['general.No-symbol']}"  >
							<h:outputText value="#{idx + 1}" />
						</p:column>

                            <!--  Име получател -->
						<p:column width="210" sortBy="#{row.A11}" headerText="#{labels['opis.polu']}"   >  
														
							<h:outputText value="#{row[11]}" />  
						</p:column>
						
						    <!--  Дата на предаване -->
						<p:column width="120" sortBy="#{row.A8}" headerText="#{labels['opis.datPred']}"  style="text-align:center;"  >  
														
							<h:outputText value="#{row[8]}" >       
							
								<f:convertDateTime pattern="dd.MM.yyyy HH:mm" timeZone="#{opisBezZachDeloPrepList.timeZone}"/>
							</h:outputText>
						</p:column>
						
						     <!--  Рег. номер -->
                        <p:column width="100" sortBy="#{row.A2}"  headerText="#{labels['opis.regN']}"  >     <!--      -->
                                        				         
							<h:outputText value="#{row[2]}" />
						</p:column>
						
						    <!--  Дата на регистр. дело -->
						 <p:column width="80"  sortBy="#{row.A5}" headerText="#{labels['docu.docDate']}" style="text-align:center;" >									  
							<h:outputText value="#{row[5]}">	
								<f:convertDateTime pattern="dd.MM.yyyy" timeZone="#{opisZachList.timeZone}"/>
							</h:outputText>							    
						</p:column>
						
						<!--   Относно за дело  opis.otnDelo --> 
						<p:column width="*" styleClass="col200"  headerText="#{labels['docu.nameDelo']}">
							<h:outputText value="#{row[17]}"  />								    
						</p:column>
						
						   <!--  Тип дело -->
						 <p:column width="100" sortBy="#{row.A6}" headerText="#{labels['opis.tipDelo']}"  >        
														
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DELO_TYPE, row[6], opisBezZachDeloPrepList.currentLang, now)}" />
						</p:column>
																		
						      <!--  Номер том. -->   <!-- row[1] - idDelo,  row[12] - ном. том-->
						 <p:column width="40" sortBy="#{row.A12}" headerText="#{labels['opis.nomTom']}"  style="text-align:center;" >   
														
							<h:outputText value="#{row[12]}" />  
						</p:column>
						
						  <!--  Начин на предаване -->
						  
						 <p:column width="90" sortBy="#{row.A9}" headerText="#{labels['docDvijenie.nachin']}" exportable="false"  rendered="false" >          														
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DVIJ_METHOD, row[9], opisBezZachDeloPrepList.currentLang, now)}" />
						</p:column>
						
					    <p:column width="20" exportable="false">
								<p:commandButton icon="fas fa-trash" action="#{opisBezZachDeloPrepList.actionDeleteDoc(row[0])}" style="font-size: 8pt;"
									ajax="true" title="#{labels['opis.delFromSp']}" styleClass="ui-button-danger" update="@form" >
									<p:confirm header="#{ui_labels['general.comfirmation']}" message="#{labels['opis.messPotv']}" icon="fas fa-exclamation-triangle" />
								</p:commandButton>  
						</p:column>
					</p:dataTable>
                 
				</h:panelGroup>	
				
          
     <!--   </div>    -->
           
           <!--  ******************************************************************************************************************* --> 
          
          <!--  За избор на нови предадени дела/преписки -->
          <!--  ******************************************************************************************************************* --> 
          <p:dialog appendTo="@form"  closeOnEscape="true"
		    header="#{opisBezZachDeloPrepList.zaglModal}" 
		    fitViewport="true"		
		    responsive="true"  
		    resizable="true"
		    
		    position="top" width="95%"  style="font-size: 10pt; margin-top:50px !important" 
			widgetVar="modalSelDocs" dynamic="true" id="modalSelDocsIdM" 
			modal="true">
			
			  <p:ajax event="close" listener="#{opisBezZachDeloPrepList.handleCloseDialogSelDocs}" process="@this" update="formOpisiBezPrep"  />
			<p:outputPanel  id="panelSelDocs" >
			     <p:messages>
			        <p:autoUpdate />
			     </p:messages>
			     
			      
			     	<!-- FILTER -->	
			 
				<h:panelGroup id="panelFilter" >

					<div class="card">
	                      <div class="p-grid p-align-end">	
	                         <span style="padding-left:10px"></span>
							     <!--Регистратура-->														
								<div class="p-col-12">
									  <h:outputText value="#{labels['users.registratura']}: #{opisBezZachDeloPrepList.nameRegistrPotreb}" styleClass="form-label"/>
								</div>
						 </div>     
					
						<div class="p-grid">
	                        <!--   Период за дата предаване  -->
							<div class="p-col-12 p-sm-12 p-md-6 p-lg-4 p-xl-4  ui-fluid">
								<h:outputText value="#{labels['opis.periodPred']}" styleClass="form-label req" />
								<div class="ui-inputgroup">
								    <p:focus id="focusPer" for="period" />	
									<p:selectOneMenu id="period" value="#{opisBezZachDeloPrepList.period}">
										<f:selectItem value="#{null}" itemValue="#{null}" />
										<f:selectItems value="#{systemData.getSysClassification(OmbConstants.CODE_CLASSIF_PERIOD_NOFUTURE, now, opisBezZachDeloPrepList.currentLang)}"
											var="clPer" itemLabel="#{clPer.tekst}" itemValue="#{clPer.code}" />
										<p:ajax event="change" update="period dateOt dateDo" listener="#{opisBezZachDeloPrepList.changePeriod}"/>  
									</p:selectOneMenu>
								</div>	
							</div>
	                         
	                         <span style="padding-left:20px"></span>
							<div class="p-col-12 p-sm-6 p-md-3 p-lg-3 p-xl-3  ui-fluid">
								<h:outputText value="#{ui_labels['general.dataOt']}" styleClass="form-label" />
								<p:datePicker id="dateOt" pattern="dd.MM.yyyy HH:mm" mask="true" showIcon="true" showTime="true"  locale="bg" 
											value="#{opisBezZachDeloPrepList.dateFrom}" >
									<p:ajax event="change" update="period" listener="#{opisBezZachDeloPrepList.changeDate}"/>
									<p:ajax event="dateSelect" update="period" listener="#{opisBezZachDeloPrepList.changeDate}"/> 
								</p:datePicker>
							</div>
	                         
	                         <span style="padding-left:20px"></span>
							<div class="p-col-12 p-sm-3 p-md-3 p-lg-3  p-xl-3  ui-fluid">
								<h:outputText value="#{ui_labels['general.dataDo']}" styleClass="form-label" />
								<p:datePicker id="dateDo" pattern="dd.MM.yyyy HH:mm" mask="true"  showIcon="true" showTime="true"  locale="bg" 
											value="#{opisBezZachDeloPrepList.dateTo}" >
									<p:ajax event="change" update="period" listener="#{opisBezZachDeloPrepList.changeDate}"/>
									<p:ajax event="dateSelect" update="period" listener="#{opisBezZachDeloPrepList.changeDate}"/>
								</p:datePicker>
							</div>
	
						</div>
					
						 
						 <!--    Предаден на - код от Адм. стр. -->
						<div class="p-col-11 p-sm-11 p-md-11 p-lg-11 p-xl-11  ui-fluid">	
							<h:outputText value="#{labels['opis.predNa']}" styleClass="form-label"/>
							 
							<ibg:selectManyModalA id="listAdmStr" compType="2" maxResults="50"  
								codeClassif="#{OmbConstants.CODE_CLASSIF_ADMIN_STR_REPORTS}" 																
								dateClassif="#{opisBezZachDeloPrepList.decodeDate}" filtered="false"
								saveStateTree="false" showRadioBtn="true" 
								selectedCodes="#{opisBezZachDeloPrepList.codesPredNaList}"
								selectedClassifs="#{opisBezZachDeloPrepList.listPredNaClassif}"
								styleAutoComp="width:92%;"
								withBtnClear="true" /> 
							 	
						</div>
						
						 <!--    Предадени на  кореспондент . -->  
						<!-- трябва да се добави и компонента за търсене на корепоснденти?  -->
						<div class="p-col-11 p-sm-11 p-md-11 p-lg-11 p-xl-11  ui-fluid ">
						   <h:outputText value="#{labels['opis.predNaCoresp']}" styleClass="form-label"/>
						
						<!--  Множествен избор на кореспонденти     #{OmbConstants.CODE_CLASSIF_REFERENTS} -->
						  <h:panelGroup id="panelCorresp">
							
								<div class="p-grid  ui-fluid">
									<div class="p-col-12" >
										<div class="select-modal-wrapper">
									
											<ibg:selectManyModalA id="refCorrInpM" 
													codeClassif="#{OmbConstants.CODE_CLASSIF_REFERENTS}"
													compType="3" 			
													selectedCodes="#{opisBezZachDeloPrepList.codeRefCorrespList}"
													selectedClassifs="#{opisBezZachDeloPrepList.scList}"										
												    withBtnClear="true" minQueryLength="3"
													styleAutoComp="width:92%;" 
													dopInfoAutoComp="true" itemtipAtPosition="center bottom"/>
												  
											<!--  Разширено търсене на кореспондент -->
											<p:commandButton id="btnCorrS"
												onmousemove="document.getElementById('@form:btnCorrS').focus();"
												icon="fas fa-list-ul" partialSubmit="true"
												process="@form:dpCorrSearch @this"
												update="@form:dpCorrSearch"
												styleClass="select-modal-button" style="margin-right:65px;"
												oncomplete="PF('mCorrS').show();"
												title="#{labels['search.extendRef']}" />
									
										</div>
								
							
									</div>  
								</div>
												
					  <!-- 	При връщане от разширеното търсене трябва да се погрижим да се добави в списъка  !!!   -->
					  <!--  Това става с функция opisBezZachDeloPrepList.actionAddSelectRef, която се задава в <p:remoteCommand  с actionListener  -->
							</h:panelGroup>
						
						
						  <!--  Избор за един кореспондент -->
						<h:panelGroup id="cor"    rendered="false">												
							<h:outputText value="#{labels['opis.predNaCoresp']}" styleClass="form-label"/>	
							<div class="ui-inputgroup">
											
								<p:inputText value="#{opisBezZachDeloPrepList.txtCorresp}" id="coresp">	
									<p:ajax event="keyup" update="coresp" listener="#{opisBezZachDeloPrepList.actionChangeTxtCorresp}"/>   
								</p:inputText>
								<p:commandButton id="btnDelCorresp1" value="x" style="font-weight: bold;font-size: 8pt; color:black; background-color: #0000;  " 
								  title="Изтриване на въведен кореспондент" rendered="#{opisBezZachDeloPrepList.codeRefCorresp!=null or (opisBezZachDeloPrepList.txtCorresp!=null and opisBezZachDeloPrepList.txtCorresp!='') }" >
								   <p:ajax event="click"  listener="#{opisBezZachDeloPrepList.actionClearCorresp}"  update="formOpisiBezPrep:coresp formOpisiBezPrep:cor @this" />
								</p:commandButton>
											
								<!--  Разширено търсене на  кореспондент -->
								<p:commandButton id="btnCorrS1" styleClass="inputgroup-button"  
									onmousemove="document.getElementById('formOpisiBezPrep:btnCorrS1').focus();"
									icon="fas fa-list-ul" partialSubmit="true"
									process="dpCorrSearch"							
									update="formOpisiBezPrep:coresp formOpisiBezPrep:cor  @this"
									oncomplete="PF('mCorrS').show();"
									title="" />		<!-- onmousemove="document.getElementById('panelSelDocs:btnCorrS1').focus();"  -->																					
							</div>
							<p:remoteCommand name="cmdSelectCorresp" 
											update="formOpisiBezPrep:coresp formOpisiBezPrep:cor"
											process="formOpisiBezPrep:coresp formOpisiBezPrep:cor @this"
											actionListener="#{opisBezZachDeloPrepList.actionSelectCorresp}" />	
						  </h:panelGroup>																														    
						</div>
					
						<div class="title-group">
							<p:commandLink class="extended-search-toggle" onclick="toggleSection(this, '#srch-extended')">
								<h:outputText value="#{ui_labels['search.extend']}"/>
								<i class="fas fa-caret-right"></i>
							</p:commandLink>
					    </div>
					
					<div  id="srch-extended"  style="display: none;">
					 
						 <!--   Предаден на - с текст -->
						<div class="p-grid">
	
							<div class="p-col-6 p-sm-6 p-md-6 p-lg-6 p-xl-6 ui-fluid">
							     <h:outputText value="#{labels['docDvijenie.txtPredaden']}" styleClass="form-label"/>
							   <div class="ui-inputgroup">
							       <p:inputText id="txtPredaden" value="#{opisBezZachDeloPrepList.textPredNa}" onkeypress="if(event.keyCode == 13) {event.preventDefault(); $(':focus').blur()} " />
							   </div>
						 	</div>	
							
						</div>		
						
						
					 	
						<div class="p-grid">
                            <!--Регистрирано движение от потребител-->						 
							<div class="p-col-6 p-sm-6 p-md-6 p-lg-6 p-xl-6  ui-fluid">
								<h:outputText value="#{labels['opis.userRegDvij']}" styleClass="form-label"/>
								<ibg:selectOneModalA codeClassif="#{OmbConstants.CODE_CLASSIF_USERS}" 
										id="user"  dateClassif="#{opisBezZachDeloPrepList.decodeDate}" filtered="false" 													
										selectedCode="#{opisBezZachDeloPrepList.userRegDvij}" saveStateTree="true"
										withBtnClear="true" compType="4" styleAutoComp="" />
															
							</div>
							
							<!--Тип на дело/преписка -->							
							<div   class="p-col-5 p-sm-5 p-md-5 p-lg-5 p-xl-5  ui-fluid">	
								<h:outputText value="#{labels['opis.tipDelo']}" styleClass="form-label"/>
								<ibg:selectManyModalA id="lstDocsVid" compType="2" maxResults="50"
									codeClassif="#{OmbConstants.CODE_CLASSIF_DELO_TYPE}" 																
									dateClassif="#{opisBezZachDeloPrepList.decodeDate}" filtered="false"
									saveStateTree="false" showRadioBtn="true" 
									selectedCodes="#{opisBezZachDeloPrepList.deloTipList}"
									selectedClassifs="#{opisBezZachDeloPrepList.deloTipClassif}"
								    	styleAutoComp="width:82%;"
									withBtnClear="true" /> 
														
							</div>   
						 </div>	
							                   
	                   </div>
	                   
	                     <div   class="p-col-12 ui-fluid">
	                     <h:outputText value=" " />
	                     </div>
	                     
						<div class="filter-buttons">
						 
							<p:commandButton icon="fas fa-search" value="#{ui_labels['general.search']}" 
											id="btnSearchDoc" update="panelSelDocs" partialSubmit="true" style="font-size: 10pt;" 
											process="@this formOpisiBezPrep" actionListener="#{opisBezZachDeloPrepList.actionSearchInModal}"
											 title="#{ui_labels['general.titleSearch']}"  styleClass="p-mr-3"/>
	
							
							<p:commandButton icon="fas fa-eraser" value="#{ui_labels['general.clear']}" 
											 id="btnClear"   partialSubmit="true" process="@this" update="panelSelDocs"
											  actionListener="#{opisBezZachDeloPrepList.actionClear}" style="font-size: 10pt;" 
											 title="#{ui_labels['general.titleClear']}" styleClass="ui-button-warning" />
							
							
						</div>
	
					</div> 
				
				</h:panelGroup>
				
				<h:panelGroup  layout="block"  styleClass="margin-top"  rendered="#{opisBezZachDeloPrepList.delaList == null}">
				     <div  class="p-grid" >
				   
				   
		                  	   
		                       <div class="p-col-10 p-sm-10 p-md-10 p-lg-10 p-xl-10  ui-fluid" style="text-align: right;" >
		                     		                        
		                           <h:outputText value=" " />
		                       </div> 
		                       
		                       <div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" style="text-align: left;">
		                     		                       		                            
								<p:commandButton icon="fas fa-eraser" value="#{labels['opis.kamSpisak']}" 
									   partialSubmit="true" process="@this" update="formOpisiBezPrep"  styleClass="btn-normal" style="font-size: 10pt;width:85%"  rendered="false"  > 
									    <!--  rendered="#{opisBezZachDeloPrepList.delaSelList != null and opisBezZachDeloPrepList.delaSelList.rowCount > 0}"  -->
									  <p:ajax event="click" listener="#{opisBezZachDeloPrepList.handleCloseDialogSelDocs}" oncomplete="PF('modalSelDocs').hide();"  />
								 </p:commandButton>	   
									   
							  	
							  								
			         		     <p:commandButton icon="fas fa-eraser" value="#{labels['opis.close']}" 
									   partialSubmit="true" process="@this" update="formOpisiBezPrep"  styleClass="btn-normal" style="font-size: 10pt;width:60%" rendered="false" > 
									       <!--  rendered="#{opisBezZachDeloPrepList.delaSelList == null or  opisBezZachDeloPrepList.delaSelList.rowCount == 0}"   -->
									 
								     <p:ajax event="click" listener="#{opisBezZachDeloPrepList.handleCloseDialogSelDocs}" oncomplete="PF('modalSelDocs').hide();"  />
								 </p:commandButton>  	   
			         		    
			         		    
			         		    </div> 
			         		   		  						
							
						</div>
				</h:panelGroup>		
        	 			
			  <h:panelGroup id="panelTableModal" layout="block"  styleClass="margin-top"  rendered="#{opisBezZachDeloPrepList.delaList != null}">
				   <h:panelGroup id="panelTblToolbar">
					
						<div  class="p-grid" >
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid">
								<h:outputText value="#{labels['opis.brNoviDela']} #{opisBezZachDeloPrepList.delaList.rowCount}" styleClass="form-label" rendered="#{opisBezZachDeloPrepList.delaList != null}"/>
							</div>
							
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							   <h:panelGroup   rendered="#{opisBezZachDeloPrepList.docSelectedAllModal.size() > 0}">
									<span style="padding-right: 5px;" >
										<span class="fas fa-ellipsis-v" />
									</span>
								
									<h:outputText value="#{labels['opis.brIzbr']} #{opisBezZachDeloPrepList.docSelectedAllModal.size()}"  styleClass="form-label" id="brSelDocs"/>
								</h:panelGroup>
							</div>		
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							 <h:panelGroup   rendered="#{opisBezZachDeloPrepList.docSelectedAllModal.size() > 0}">
							   <p:commandButton icon="fas fa-eraser" value="#{labels['opis.razmAll']}" 
									 update="panelSelDocs " partialSubmit="true"   
									process="@this panelFilter panelTableModal" actionListener="#{opisBezZachDeloPrepList.actionRazmModal}"
									styleClass="ui-button-warning" style="width:90%" />
							  </h:panelGroup>
							  	 
						    </div>	
						   <div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
						      <h:outputText value="" />
						   </div>
						   
						   		                       
	                       
	                          <div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" style="text-align: right;" >
	                               
		                           <p:commandButton icon="fas fa-plus" value="#{labels['opis.addSpisak']}"  rendered="#{opisBezZachDeloPrepList.delaList != null and opisBezZachDeloPrepList.delaList.rowCount > 0 and opisBezZachDeloPrepList.docSelectedAllModal.size()== 0}"
									   partialSubmit="true" process="@this" update="formOpisiBezPrep"  style="font-size: 10pt;width:78%"  styleClass="ui-button-success"
									   >
									   <p:confirm header="#{ui_labels['general.comfirmation']}" message="#{labels['opis.messPotvPredDelaAllBack']}" icon="fas fa-exclamation-triangle" />
									    <p:ajax event="click" listener="#{opisBezZachDeloPrepList.handleSelDocsOKAll}" oncomplete="PF('modalSelDocs').hide();"  />
									</p:commandButton>   
		                            
                                   <p:commandButton icon="fas fa-plus" value="#{labels['opis.addSpisak']}"  rendered="#{opisBezZachDeloPrepList.docSelectedAllModal.size()> 0}"
									   partialSubmit="true" process="@this" update="formOpisiBezPrep"  style="font-size: 10pt;width:78%"  styleClass="ui-button-success"
									   >
									  <p:ajax event="click" listener="#{opisBezZachDeloPrepList.handleSelDocsOK}" oncomplete="PF('modalSelDocs').hide();"  />
									</p:commandButton>    
		                        
		                       
		                       </div> 
		                       <div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" style="text-align: left;">
		                         		                          	  
								<p:commandButton icon="fas fa-eraser" value="#{labels['opis.kamSpisak']}" 
									   partialSubmit="true" process="@this" update="formOpisiBezPrep"  styleClass="btn-normal" style="font-size: 10pt;width:85%"  rendered="false" >
									        <!-- rendered="#{opisBezZachDeloPrepList.delaSelList != null and opisBezZachDeloPrepList.delaSelList.rowCount > 0 }"    -->
									   
									  <p:ajax event="click" listener="#{opisBezZachDeloPrepList.handleCloseDialogSelDocs}" oncomplete="PF('modalSelDocs').hide();"  />
								 </p:commandButton>	    
							  								
			         		      <p:commandButton icon="fas fa-eraser" value="#{labels['opis.close']}" 
									   partialSubmit="true" process="@this" update="formOpisiBezPrep"  styleClass="btn-normal" style="font-size: 10pt;width:60%"  rendered="false" >
									      <!--  rendered="#{opisBezZachDeloPrepList.delaSelList == null or opisBezZachDeloPrepList.delaSelList.rowCount == 0}"     -->
									
									  <p:ajax event="click" listener="#{opisBezZachDeloPrepList.handleCloseDialogSelDocs}" oncomplete="PF('modalSelDocs').hide();"  />
								   </p:commandButton>	    
			         		    
			         		    </div> 	
			         						 						
							
						</div>
					  </h:panelGroup>
					  
				       	<p:dataTable id="tblDocsOpis" var="row" value="#{opisBezZachDeloPrepList.delaList}" lazy="true"  widgetVar="rowS"
						rowIndexVar="idx" emptyMessage="#{ui_labels['general.norows']} (#{labels['opis.noAddDela']})" rows="10" sortMode="single" reflow="true"
						paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
						rowsPerPageTemplate="5,10,15,20,25" paginatorPosition="bottom" paginatorAlwaysVisible="false" paginator="true"
                        rowSelectMode="checkbox"   selection="#{opisBezZachDeloPrepList.docSelectedTmpModal}" >

						<p:ajax event="toggleSelect"	 	 listener="#{opisBezZachDeloPrepList.onRowSelectAllModal}" process="@this" update="@form:panelTblToolbar"/>
												
						<p:ajax event="rowSelectCheckbox"  	 listener="#{opisBezZachDeloPrepList.onRowSelectModal}"   process="@this" update="@form:panelTblToolbar" />
						<p:ajax event="rowUnselectCheckbox"   listener="#{opisBezZachDeloPrepList.onRowUnselectModal}" process="@this" update="@form:panelTblToolbar" />
						<p:ajax event="page" listener="#{opisBezZachDeloPrepList.onPageUpdateSelectedModal}"   />
		
						
												
						<p:column selectionMode="multiple" exportable="false"  style="width:15px;text-align:center;"    />	
												
						<p:column width="25" exportable="false" headerText="#{ui_labels['general.No-symbol']}"  >
							<h:outputText value="#{idx + 1}" />
						</p:column>

						    <!--  Име получател -->
						<p:column width="210" sortBy="#{row.A11}" headerText="#{labels['opis.polu']}"   >  
														
							<h:outputText value="#{row[11]}" />  
						</p:column>
						
						    <!--  Дата на предаване -->
						<p:column width="120" sortBy="#{row.A8}" headerText="#{labels['opis.datPred']}"  style="text-align:center;"  >  
														
							<h:outputText value="#{row[8]}" >       
							
								<f:convertDateTime pattern="dd.MM.yyyy HH:mm" timeZone="#{opisBezZachDeloPrepList.timeZone}"/>
							</h:outputText>
						</p:column>
						
						     <!--  Рег. номер -->
                        <p:column width="100" sortBy="#{row.A2}"  headerText="#{labels['opis.regN']}"  >   <!--     -->
                                          				         
							<h:outputText value="#{row[2]}" />
						</p:column>
						
						    <!--  Дата на регистр. дело -->
						 <p:column width="80"  sortBy="#{row.A5}" headerText="#{labels['docu.docDate']}" style="text-align:center;" >									  
							<h:outputText value="#{row[5]}">	
								<f:convertDateTime pattern="dd.MM.yyyy" timeZone="#{opisZachList.timeZone}"/>
							</h:outputText>							    
						</p:column>
						
						<!--   Относно за дело   opis.otnDelo --> 
						<p:column width="*" styleClass="col200"  headerText="#{labels['docu.nameDelo']}">
							<h:outputText value="#{row[17]}"  />								    
						</p:column>
						
						   <!--  Тип дело -->
						 <p:column width="100" sortBy="#{row.A6}" headerText="#{labels['opis.tipDelo']}"  >        
														
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DELO_TYPE, row[6], opisBezZachDeloPrepList.currentLang, now)}" />
						</p:column>
																		
						      <!--  Номер том. -->   <!-- row[1] - idDelo,  row[12] - ном. том-->
						 <p:column width="40" sortBy="#{row.A12}" headerText="#{labels['opis.nomTom']}"  style="text-align:center;" >   
														
							<h:outputText value="#{row[12]}" />  
						</p:column>
									
					</p:dataTable>
                 
				</h:panelGroup>	
				 <!--  ******************************************************************************************************************* --> 
				
				<!--  Множествен избор на кореспонденти -->
				
				<h:panelGroup id="dpCorrSearch">	
	              <p:remoteCommand name="cmdAddRef" 
	 				process="@this"		
	 				update="@form:panelCorresp"
	  				actionListener="#{opisBezZachDeloPrepList.actionAddSelectRef}" />
	  				
						<p:dialog appendTo="@form"  closeOnEscape="true"
						    header="#{labels['docu.titleExtSrchCoresp']}" 
						    fitViewport="true"	
						    responsive="true" 
						    resizable="true"
						    position="top"	  
							widgetVar="mCorrS" dynamic="true" id="modalCorrS" 
							modal="true">
							<div class="container #{guestPreferences.containerPosition}">		
								
								 	<ibg:refCorrespSearch id="mCorrS" myId="cCorr1"
										 codeRef="#{opisBezZachDeloPrepList.codeRefCorrSrch}"															
										 modal="true"
										 update="@form:panelCorresp"
										 onComplete = "cmdAddRef()"/>
								
							</div>
										
						</p:dialog>	
					</h:panelGroup>
			         
			         <!-- Избор на един кореспондент  -->  
			        <h:panelGroup id="dpCorrSearch1"  rendered="false">
						<p:dialog appendTo="@form"   position="top"
						fitViewport="true"		
					    responsive="true"  
					    resizable="true"
							header="Разширено търсене на кореспондент" minWidth="650" 
							width="950" widgetVar="mCorrS" dynamic="true" id="modalCorrS1" modal="true">
								<ibg:refCorrespSearch id="mCorrS1" myId="cCorr2" 
									codeRef="#{opisBezZachDeloPrepList.codeRefCorresp}"
									searchTxt="#{opisBezZachDeloPrepList.txtCorresp}"
									dateClassif="#{opisBezZachDeloPrepList.decodeDate}"
									modal="true" update="formOpisiBezPrep:coresp"
									onComplete="PF('mCorrS1').hide();  cmdSelectCorresp()" />
			
						</p:dialog>
					</h:panelGroup>           
			                        
			</p:outputPanel>
			  
	      </p:dialog>		  
          
          
          <!--   Избрани предадени дела/преписки за формиране на опис -->
           <!--  ******************************************************************************************************************* --> 
          <p:dialog appendTo="@form"  closeOnEscape="true"
		    header="#{opisBezZachDeloPrepList.zaglModal} " 
		    fitViewport="true"		
		    responsive="true"  
		    resizable="true"
		    
		    position="top" style="font-size: 10pt; margin-top:50px !important" 
			widgetVar="modalFormOpis" dynamic="true" id="modalFormOpisIdM" 
			modal="true">
			
			  <p:ajax event="close" listener="#{opisBezZachDeloPrepList.handleCloseDialogFormOpis}" process="@this" update="formOpisiBezPrep"  />
			  <h:panelGroup rendered="false" >
                              <h:outputText value="#{labels['opis.sort']}:"   style="font-weight: bold; " />
			       				 <p:selectOneRadio  id="wh_data"  value="#{opisBezZachDeloPrepList.vidSort}"  style="font-weight: bold;color:blue;" >                                                                
			                          <f:selectItem itemValue="0" itemLabel="#{labels['opis.sortPoluchDela']}"  />                 
			                          <f:selectItem itemValue="1" itemLabel="#{labels['opis.sortTipDelo']}"  />
			                          <p:ajax event="click" listener="#{opisBezZachDeloPrepList.actionSort}"  process="@this" partialSubmit="true"  update="panelT tblDocs" />
			                          
			                     </p:selectOneRadio>
			  </h:panelGroup> 
			  
			  <div class="filter-buttons">
			      <h:outputText value="#{labels['opis.exportv']}: "  styleClass="p-mr-3"/>
			          
						<h:commandLink  actionListener="#{opisBezZachDeloPrepList.htmlExport}"  target="_blank" style="color:blue;vertical-align: middle;font-size:10pt;" styleClass="p-mr-3">
						   <!--  <h:graphicImage library="images" name="html.png"  /> -->  <!--  style="font-size:10pt;"  -->
						   <h:outputText value="Html" />
						     <i class="fab fa-html5" />
				             <!--  <i class="fas fa-print" />  -->
						</h:commandLink>
													
						<h:commandLink  actionListener="#{opisBezZachDeloPrepList.wordExport}"  target="_blank" style="color:blue;vertical-align: middle;font-size:10pt;" styleClass="p-mr-3" >
						    <!--   <h:graphicImage library="images" name="word.png"  /> -->  
				       		<h:outputText value="Word" />
				       		 <i class="fas fa-file-word" />
						</h:commandLink>
						
						<h:commandLink  actionListener="#{opisBezZachDeloPrepList.excelExport}" target="_blank" style="color:blue;vertical-align: baseline; font-size:10pt;"  >
				       	  <!--   <h:graphicImage library="images" name="excel.png"  />   --> 
					       <h:outputText value="Excel"  />
					        <i class="fas fa-file-excel" />
						</h:commandLink> 
			  </div>
			
			  <h:panelGroup id="panelT" layout="block"  styleClass="margin-top"  >
									  
				       	<p:dataTable id="tblDocs" var="row" value="#{opisBezZachDeloPrepList.docSelectedAllMT}" lazy="true"  
						rowIndexVar="idx" emptyMessage="#{ui_labels['general.norows']}" rows="10" sortMode="single" reflow="true"
						style="font-size: 10pt;"
						paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
						rowsPerPageTemplate="5,10,15,20,25" paginatorPosition="bottom" paginatorAlwaysVisible="true" paginator="true"
                         >

						
						<p:column width="20" exportable="false" headerText="#{ui_labels['general.No-symbol']}" >
							<h:outputText value="#{idx + 1}" />
						</p:column>

							    <!--  Име получател -->
						<p:column width="210"  headerText="#{labels['opis.polu']}"   >  
														
							<h:outputText value="#{row[11]}" />  
						</p:column>
						
						    <!--  Дата на предаване -->
						<p:column width="120"  headerText="#{labels['opis.datPred']}"  style="text-align:center;"  >  
														
							<h:outputText value="#{row[8]}" >       
							
								<f:convertDateTime pattern="dd.MM.yyyy HH:mm" timeZone="#{opisBezZachDeloPrepList.timeZone}"/>
							</h:outputText>
						</p:column>
						
						     <!--  Рег. номер -->
                        <p:column width="100"   headerText="#{labels['opis.regN']}"  >  
                                        				         
							<h:outputText value="#{row[2]}" />
						</p:column>
						
						    <!--  Дата на регистр. дело -->
						 <p:column width="80"   headerText="#{labels['docu.docDate']}" style="text-align:center;" >									  
							<h:outputText value="#{row[5]}">	
								<f:convertDateTime pattern="dd.MM.yyyy" timeZone="#{opisZachList.timeZone}"/>
							</h:outputText>							    
						</p:column>
						
						<!--   Относно за дело  opis.otnDelo --> 
						<p:column width="*" styleClass="col200"  headerText="#{labels['docu.nameDelo']}">
							<h:outputText value="#{row[17]}"  />								    
						</p:column>
						
						   <!--  Тип дело -->
						 <p:column width="100"  headerText="#{labels['opis.tipDelo']}"  >        
														
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DELO_TYPE, row[6], opisBezZachDeloPrepList.currentLang, now)}" />
						</p:column>
																		
						      <!--  Номер том. -->   <!-- row[1] - idDelo,  row[12] - ном. том-->
						 <p:column width="40"  headerText="#{labels['opis.nomTom']}"  style="text-align:center;" >   
														
							<h:outputText value="#{row[12]}" />  
						</p:column>
					
					</p:dataTable>
                 
				</h:panelGroup>	
			   
			 
			 	<div class="p-grid">
							
							 <div   class="p-col-12 ui-fluid">
	                           <h:outputText value=" " />
	                         </div>
	
							<p:commandButton icon="fas fa-eraser" value="#{labels['opis.close']}" 
								   partialSubmit="true" process="@this" update="formOpisiBezPrep"  
								    rendered="false"  >
								 <p:ajax event="click" listener="#{opisBezZachDeloPrepList.handleCloseDialogFormOpis}" oncomplete="PF('modalFormOpis').hide();"  />
						     </p:commandButton>		    
								
			    </div>               <!-- styleClass="ui-button-secondary"  styleClass="ui-button-success" -->
					
		</p:dialog>
	     <!--  ******************************************************************************************************************* --> 
	          
		</h:form>
        
    </ui:define>

</ui:composition>