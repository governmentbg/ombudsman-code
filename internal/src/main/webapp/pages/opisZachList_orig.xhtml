<ui:composition xmlns="http://www.w3.org/1999/xhtml"
            	 xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:jsf="http://xmlns.jcp.org/jsf"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:p="http://primefaces.org/ui"
				xmlns:ibg="http://java.sun.com/jsf/composite/components"
                template="/template/template.xhtml">
                
        <ui:define name="metadata">
			<f:metadata>
			   <f:importConstants type="com.ib.omb.system.OmbConstants" />
			</f:metadata>
		</ui:define> 
		
	<ui:define name="title">#{navTexts['/pages/opisZachList.xhtml']}</ui:define>

	<ui:define name="viewname">
	    
		<li>#{navTexts['/pages/opisZachList.xhtml']}</li>
	</ui:define>
		
	
    <ui:define name="content">
          <h:form id="formOpisZach">
		   

	<!--    <div class="container #{guestPreferences.containerPosition}">     -->
			          <div  class="p-grid" >
							  <div class="p-col-5 p-sm-5 p-md-5 p-lg-5 p-xl-5  ui-fluid p-mr-3" >
							         
							  </div>
							  <div class="p-col-7 p-sm-7 p-md-7 p-lg-7 p-xl-7  ui-fluid" >
							  
							        <h:outputLabel value="#{labels['opis.raznZach']}" style="font-weight:bold;"  />
							       
							  </div>
					  </div>	
			
				
			       <!--  Главни 2 бутона - търсене (поредно търсене за нови документи за предаване) и изчистване за целия екран - на филтри и всички намерени предадени документи  -->
			  <!--  *******************************************************************************************************************`***************************** --> 
				<h:panelGroup id="panelAllDocs"  style="width:95%">

					<!-- <div class="card">   -->
					   <div class="p-grid">
					   
						   						   
							 <div class="p-col-6 p-sm-6 p-md-6 p-lg-6 p-xl-6  ui-fluid" style="text-align: right;">
							        <h:outputLabel value="#{labels['opis.helpForIzbZach']}" style="color:blue"  />
							 </div>
					
						
						  <div class="p-col-3 p-sm-3 p-md-3 p-lg-3 p-xl-3 ui-fluid" style="text-align: right;">
							  
		                        <p:commandButton icon="fas fa-search" value="#{labels['opis.searchDoc']}" 
												id="btnOpenSearchDoc" update="formOpisZach" partialSubmit="true"
												process="@this formOpisZach" actionListener="#{opisZachList.actionSelDocs}"
												style="width:88%;"  />   <!--  title="#{ui_labels['general.titleSearch']}" -->
		
								 
		                        
		                    </div>
		                     <div class="p-col-3 p-sm-3 p-md-3 p-lg-3 p-xl-3 ui-fluid" style="text-align: left;">    
								<p:commandButton icon="fas fa-eraser" value="#{labels['opis.clearAll']}" rendered="#{opisZachList.docsSelList != null and opisZachList.docsSelList.rowCount > 0}"
												 id="btnClearAll"   partialSubmit="true" process="@this" update="formOpisZach"
												  actionListener="#{opisZachList.actionClearAll}"
												 styleClass="ui-button-warning" style="width:80%;" />   <!--   -->
		                      </div>
	                     								
						</div>
	
				<!--  	</div> -->
				
				</h:panelGroup>
				 <!--  ******************************************************************************************************************* --> 
        	 	
        	 	<!--   Основна таблица със събрани   документи - на основния екран -->
        	 	 <!--  ******************************************************************************************************************* --> 		
			  <h:panelGroup id="panelTable" layout="block"  styleClass="margin-top"   rendered="#{opisZachList.docsSelList != null}"  >   <!-- rendered="#{opisZachList.docsSelList != null}"  -->
				   <h:panelGroup id="panelTableToolbar">
				         <div  class="p-grid" >
							  <div class="p-col-3 p-sm-3 p-md-3 p-lg-3 p-xl-3 p-mr-3 ui-fluid" >
							       
							  </div>
							  <div class="p-col-8 p-sm-8 p-md-8 p-lg-8 p-xl-8  ui-fluid" >
							        <h:outputLabel value="#{labels['opis.formOpisZachWithDocInRegistr']}" style="font-weight:bold;" />   <!-- opis.formOpisZach  -->
							  </div>
					  	</div>	
					
						<div  class="p-grid" >
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid">
								<h:outputText value="#{ui_labels['general.reportResult']} #{opisZachList.docsSelList.rowCount}" styleClass="form-label" rendered="#{opisZachList.docsSelList != null}"/>
								<h:outputText value="#{ui_labels['general.reportResult']} 0 " styleClass="form-label" rendered="#{opisZachList.docsSelList == null}"/>
							</div>
							
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							   <h:panelGroup   rendered="#{opisZachList.docSelectedAllM.size() > 0}">
									<span class="ui-separator" style="padding-right: 5px;" >
										<span class="fas fa-ellipsis-v" />
									</span>
								
									<h:outputText value="#{labels['opis.brIzbr']} #{opisZachList.docSelectedAllM.size()}"  styleClass="form-label" id="brSel"/>
								</h:panelGroup>
							</div>		
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							 <h:panelGroup   rendered="#{opisZachList.docSelectedAllM.size() > 0}">
							   <p:commandButton icon="fas fa-eraser" value="#{labels['opis.razmAll']}" 
									 update="formOpisZach " partialSubmit="true"   style="font-size:10pt;width:92%"
									process="@this panelFilter panelTable" actionListener="#{opisZachList.actionRazm}"
									styleClass="ui-button-warning"  />
							  </h:panelGroup>		
						    </div>	
						   <div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
						      <h:outputText value="" />
						   </div>		  
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							 <h:panelGroup   rendered="#{opisZachList.docSelectedAllM.size() > 0}" style="text-align: center;" >
							     	
						         <p:commandButton icon="fas fa-eraser" value="#{labels['opis.zadPoluch']}" 
								   partialSubmit="true" process="@this" update="zadPoluch formOpisZach"  style="font-size:10pt;width:90%"
								   actionListener="#{opisZachList.actionOpenModalPoluch}" />   
							 						 
							 </h:panelGroup>
							     	<h:panelGroup   rendered="#{opisZachList.docSelectedAllM.size() == 0}" >
						     		   <h:outputText value="" />
						     		</h:panelGroup>				   
						    </div>
						   
						    <div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							 <h:panelGroup   rendered="#{opisZachList.docSelectedAllMOpis.size() > 0}" style="text-align: center;" >
							    							 
							   <p:commandButton icon="fas fa-search" value="#{labels['opis.zach']}" 
									 update="formOpisZach " partialSubmit="true"   style="font-size:10pt;width:90%"
									process="@this panelFilter panelTable" actionListener="#{opisZachList.actionIzbrForOpis}"
									styleClass="ui-button-success"  />
							 </h:panelGroup>						   
						    </div>						
						</div>					
					    </h:panelGroup>
										                                                       <!-- #{ui_labels['general.norows']} --> 
				       	<p:dataTable id="tblDocsOpisList" var="row" value="#{opisZachList.docsSelList}" lazy="true"  widgetVar="rowS"
						rowIndexVar="idx" emptyMessage="#{labels['opis.noPredDok']}" rows="10" sortMode="single" reflow="true"
						paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
						 paginatorPosition="bottom" paginatorAlwaysVisible="true" paginator="true"
                          rowsPerPageTemplate="5,10,15,20,25"    rowSelectMode="checkbox"   selection="#{opisZachList.docSelectedTmp}"  >

						<p:ajax event="toggleSelect"	 	 listener="#{opisZachList.onRowSelectAll}" process="@this" update="@form:panelTableToolbar"/>
												
						<p:ajax event="rowSelectCheckbox"	 listener="#{opisZachList.onRowSelect}"   process="@this" update="@form:panelTableToolbar" />
						<p:ajax event="rowUnselectCheckbox"  listener="#{opisZachList.onRowUnselect}" process="@this" update="@form:panelTableToolbar" />
						<p:ajax event="page" listener="#{opisZachList.onPageUpdateSelected}"   />
		
						
						<f:facet name="{Exporters}">

							<div style="float: left">

								<h:commandLink id="excel">
									<h:graphicImage library="images" name="excel2.png" />
									
								  <p:dataExporter type="xls" target="tblDocsOpisList" fileName="opisZachListXls"  postProcessor="#{opisZachList.postProcessXLS}" />  
								</h:commandLink>   
<ui:remove><!-- 
								<h:commandLink id="pdf">
									<h:graphicImage library="images" name="pdf.png" />
									 <p:dataExporter type="pdf"  target="tblDocsOpisList" fileName="opisZachListPdf" encoding="windows-1251"
					        			preProcessor="#{opisZachList.preProcessPDF}" options="#{opisZachList.pdfOptions()}"/>	
			        	 	
								</h:commandLink>    

								<h:commandLink id="csv">
									<h:graphicImage library="images" name="csv.png" />
									<p:dataExporter type="csv" target="tblDocsOpisList" fileName="opisZachListCsv" encoding="CP1251" />
								</h:commandLink>
 --></ui:remove>
							</div>

						</f:facet>    
			
						
						<p:column selectionMode="multiple" exportable="false"  style="width:15px;text-align:center;"    rendered="#{!opisZachList.getVisCheck(row[0])}"/>	
						<p:column  exportable="false"  style="width:15px;text-align:center;"   rendered="#{opisZachList.getVisCheck(row[0])}" >    <!-- Тази колона замества първата, когато е забранено маркирането -->
							<h:outputText value=" "/>    
						</p:column>
						
						<p:column width="25" exportable="false" headerText="#{ui_labels['general.No-symbol']}"  >
							<h:outputText value="#{idx + 1}" />
						</p:column>
						<p:column  width="25" exportable="false" >	
							<p:button  icon="fas fa-eye" href="#{opisZachList.actionGoto(row[0])}" target="_blank" 
							           title="#{ui_labels['general.view']}" 
					  				   >
					  		</p:button>	
					    </p:column>		

                      <p:column width="110" sortBy="#{row.A2}" headerText="#{labels['repDoc.regnom']}">
							<h:outputText value="#{row[2]}"  />								    
						</p:column>
						
						<p:column width="110" sortBy="#{row.A5}" headerText="#{labels['docu.docDate']}" >									  
							<h:outputText value="#{row[5]}">	
								<f:convertDateTime pattern="dd.MM.yyyy" timeZone="#{opisZachList.timeZone}"/>
							</h:outputText>							    
						</p:column>
						
						<p:column width="*" styleClass="col200" sortBy="#{row.A17}" headerText="#{labels['docu.otnosno']}">
							<h:outputText value="#{row[17]}"  />								    
						</p:column>
						
						<p:column width="*"  styleClass="col200" sortBy="#{row.A19}" headerText="#{labels['docList.idvaOtAvtori']}">
							<h:outputText rendered="#{row[6]==OmbConstants.CODE_ZNACHENIE_DOC_TYPE_IN}" value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_REFERENTS, row[19], opisZachList.currentLang, now)}"/>					    
							<h:outputText rendered="#{row[6]==OmbConstants.CODE_ZNACHENIE_DOC_TYPE_OWN or row[6]==OmbConstants.CODE_ZNACHENIE_DOC_TYPE_WRK}" value="#{systemData.decodeItems(OmbConstants.CODE_CLASSIF_ADMIN_STR_REPORTS, row[20], opisZachList.currentLang, now)}"/>
						</p:column>
						
						<p:column width="100" sortBy="#{row.A6}" headerText="#{labels['docu.type']}">
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DOC_TYPE, row[6], opisZachList.currentLang, now)}"/>					    
						</p:column>
						
						<p:column width="100" sortBy="#{row.A7}" headerText="#{labels['docu.vid']}">
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DOC_VID, row[7], opisZachList.currentLang, now)}"/>					    
						</p:column>
						
						<p:column width="160" sortBy="#{row.A16}" headerText="#{labels['docu.register']}">
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_REGISTRI, row[16], opisZachList.currentLang, now)}"/>					    
						</p:column>
										
						
					    <p:column width="20" exportable="false">
								<p:commandButton icon="fas fa-trash" action="#{opisZachList.actionDeleteDoc(row[0])}" style="font-size: 8pt;"
									ajax="true" title="#{labels['opis.delFromSp']}" styleClass="ui-button-danger" update="@form" >
									<p:confirm header="#{ui_labels['general.comfirmation']}" message="#{labels['opis.messPotv']}" icon="fas fa-exclamation-triangle" />
								</p:commandButton>  
						</p:column>
					</p:dataTable>
                 
				</h:panelGroup>	
				
          
     <!--   </div>    -->
           
           <!--  ******************************************************************************************************************* --> 
          
          <!--  За избор на нови  документи -->
          <!--  ******************************************************************************************************************* --> 
          <p:dialog appendTo="@form"  closeOnEscape="true"
		    header="#{opisZachList.zaglModal}" 
		    fitViewport="true"		
		    responsive="true"  
		    resizable="true"
		    
		    position="top" width="95%"  style="font-size: 10pt; margin-top:50px !important" 
			widgetVar="modalSelDocs" dynamic="true" id="modalSelDocsIdM" 
			modal="true">
			
			 <p:ajax event="close" listener="#{opisZachList.handleCloseDialogSelDocs}" process="@this"  update="formOpisZach"  />
			<p:outputPanel  id="panelSelDocs" >
			     <p:messages>
			        <p:autoUpdate />
			     </p:messages>
			     
			      
			   <!-- FILTER -->	
			<h:panelGroup id="panelFilter" >
			<div class="card">
				<div class="p-grid p-align-end">
					  					 
					  <!--Регистратура-->														
					<div class="p-col-12">
						  <h:outputText value="#{labels['users.registratura']}: #{opisZachList.nameRegistrPotreb}" styleClass="form-label"/>
					</div>
					<div class="p-grid p-align-end">														
						<!--Регистрационен номер-->														
						<div class="p-col-12 p-sm-12 p-md-12 p-lg-3 p-xl-4 ui-fluid">	
							<h:outputText value="#{labels['repDoc.regnom']}" styleClass="form-label"/>
							<div class="ui-inputgroup">
								<p:inputText value="#{opisZachList.searchDoc.rnDoc}" id="rnDoc"/>
								<p:focus id="focusRnDoc" for="rnDoc" />	
								<p:selectBooleanButton id="rndEq" value="#{opisZachList.searchDoc.rnDocEQ}" 
										onLabel="Да"
										offLabel="Не"
										title="Търсене по пълно съвпадение на рег. номер" 
										onIcon="fas fa-toggle-on"  
										offIcon="fas fa-toggle-off" 
										styleClass="inputgroup-button" >
										<p:ajax update="@this rnDoc" partialSubmit="true"	process="@this rnDoc"/>			
									</p:selectBooleanButton>
							</div>
						</div>
						<!--Техен номер-->															 
						<div class="p-col-12 p-sm-12 p-md-12 p-lg-3 p-xl-4 ui-fluid">	
							<h:outputText value="#{labels['docList.theirNum']}" styleClass="form-label"/>
							<div class="ui-inputgroup">
								<p:inputText value="#{opisZachList.searchDoc.tehNomer}" id="tehNom"/>																				 													 
									<p:selectBooleanButton id="tehNomEq" value="#{opisZachList.searchDoc.tehNomerEQ}" 
												      	    onLabel="Да"
												    	    offLabel="Не"
															title="Търсене по пълно съвпадение на техен номер" 
														    onIcon="fas fa-toggle-on"  
															offIcon="fas fa-toggle-off" 
															styleClass="inputgroup-button">
															<p:ajax update="@this tehNom" partialSubmit="true" process="@this tehNom"/>			
									</p:selectBooleanButton>	
							</div>									    	
						</div>
						
						<!--Относно-->		
						<div class="p-col-12 p-sm-12 p-md-12 p-lg-3 p-xl-4 ui-fluid">	
							<h:outputText value="#{labels['docu.otnosno']}" styleClass="form-label"/>
							<p:inputText value="#{opisZachList.searchDoc.otnosno}" id="otnosno"/>
												  
						</div>						    	
						<!--Период на регистрация-->	
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">
							<h:outputText value="#{labels['doc.lstPeriod']}" styleClass="form-label"/>
							<p:selectOneMenu id="idPerR" value="#{opisZachList.periodR}"  >
							     <f:selectItem value="#{null}" itemValue="#{null}"/>
							   
							     <f:selectItems  value="#{systemData.getSysClassification(OmbConstants.CODE_CLASSIF_PERIOD_NOFUTURE, now, opisZachList.currentLang)}" 
							         var="clPer" itemLabel="#{clPer.tekst}" itemValue="#{clPer.code}" />
							       
							     <p:ajax event="change" update="idPerR dateOtReg dateDoReg" listener="#{opisZachList.changePeriodR}"/>   
						    </p:selectOneMenu>
					   </div>
					   
					   <div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-2  ui-fluid">																	
							<h:outputText value="#{ui_labels['general.dataOt']}" styleClass="form-label"/>
							<p:datePicker id="dateOtReg" pattern="dd.MM.yyyy" mask="true"  showIcon="true"  locale="bg"  
								value="#{opisZachList.searchDoc.docDateFrom}"  >
								<p:ajax event="change" update="idPerR" listener="#{opisZachList.changeDate}"/>
								<p:ajax event="dateSelect" update="idPerR" listener="#{opisZachList.changeDate}"/>      
							 </p:datePicker>
					  </div>
												
					  <div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-2  ui-fluid">
							<h:outputText value="#{ui_labels['general.dataDo']}" styleClass="form-label"/>
							<p:datePicker id="dateDoReg" pattern="dd.MM.yyyy" mask="true" showIcon="true" locale="bg" 
								value="#{opisZachList.searchDoc.docDateTo}"  >
								<p:ajax event="change" update="idPerR" listener="#{opisZachList.changeDate}"/>   
								<p:ajax event="dateSelect" update="idPerR" listener="#{opisZachList.changeDate}"/>   
							</p:datePicker>												    
					 </div>
			 
					 <!--Тип на документа-->															
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4 ui-fluid">					
							<p:selectManyCheckbox value="#{opisZachList.searchDoc.docTypeArr}" id="typeDoc"	>
								<f:selectItems value="#{opisZachList.docTypeList}" />
								<p:ajax event="change" listener="#{opisZachList.changeDocType}"  update="formOpisZach:triCheckGroup"/>
							</p:selectManyCheckbox>
						</div>
																
						<!--Вид на документа-->							
						<div   class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">	
							<h:outputText value="#{labels['docu.vid']}" styleClass="form-label"/>
							<ibg:selectManyModalA id="lstDocsVid" compType="2" maxResults="50"
								codeClassif="#{OmbConstants.CODE_CLASSIF_DOC_VID}" 																
								dateClassif="#{opisZachList.decodeDate}" filtered="false"
								saveStateTree="false" showRadioBtn="true" 
								selectedCodes="#{opisZachList.searchDoc.docVidList}"
								selectedClassifs="#{opisZachList.docsVidClassif}"
								styleAutoComp="width:100%;"
								withBtnClear="true" /> 
													
						</div>
						
						<!--Регистър-->							 
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">	
							<h:outputText value="#{labels['docu.register']}" styleClass="form-label"/>
							<h:panelGroup id="register">
								<ibg:selectManyModalA compType="2" maxResults="50" 
									codeClassif="#{OmbConstants.CODE_CLASSIF_REGISTRI}"
									dateClassif="#{opisZachList.decodeDate}" filtered="false"
									selectedCode="#{opisZachList.searchDoc.registerIdList}"
									selectedClassifs="#{opisZachList.docsRegistriClassif}" 
									specifics="#{opisZachList.specificsRegister}" sortByName="true"
									saveStateTree="false" withBtnClear="true" showRadioBtn="true" 
									styleAutoComp="width:100%;" />
							</h:panelGroup>																	   
						</div>
							
					   		<!--Регистрирани като официални-->							 
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid" jsf:id="triCheckGroup">	
						 	<h:panelGroup  rendered="#{opisZachList.visibleCheckWork}" >
					 	  		<h:outputText value="#{labels['docList.oficialni']}" styleClass="form-label"/>
							  	<p:selectOneRadio value="#{opisZachList.triCheckWork}" id="triCheckWork" >
										<f:selectItem  itemValue="1" itemLabel="да"/>
										<f:selectItem  itemValue="2" itemLabel="не"/>
										<f:selectItem  itemValue="0" itemLabel="всички"/>
								</p:selectOneRadio>								
							</h:panelGroup>		
						</div>
					    <div class="p-col-12">
							<p:commandLink class="extended-search-toggle" onclick="toggleSection(this, '#event-extended')">
								<h:outputText value="#{ui_labels['search.extend']}"/>
								<i class="fas fa-caret-right"></i>
							</p:commandLink>
						</div>	
					</div>
																																								 
					<div class="p-grid extended-search p-align-end" id="event-extended" style="display: none;">
													
						<!--Наименование-->							
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">	
							<h:outputText value="#{labels['docu.nameDelo']}" styleClass="form-label"/>
							<p:inputText value="#{opisZachList.searchDoc.docName}" id="nameDoc"/>													   
						</div>
						
						<!--Доп.инф.-->
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">	
							<h:outputText value="#{labels['docu.dopInfo']}" styleClass="form-label"/>
							<p:inputText value="#{opisZachList.searchDoc.docInfo}" id="dopInfo"/>												    
						</div>
						
						<!--Регистратура   не се показва -->								
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid" jsf:rendered="#{opisZachList.showRegistaturiList}">	
							<h:outputText value="#{labels['users.registratura']}" styleClass="form-label" />
							
								<p:remoteCommand name="cmdChangeReg" update="formOpisZach:register"
										partialSubmit="true" process="formOpisZach:register @this"
										actionListener="#{opisZachList.actionChangeReg}" />
										
								<ibg:selectOneModalA  codeClassif="#{OmbConstants.CODE_CLASSIF_REGISTRATURI_OBJACCESS}" 
									disabledInp="#{!opisZachList.disableRegList}" 
									id="registratura" dateClassif="#{opisZachList.decodeDate}" filtered="true" 	rendered="#{opisZachList.showRegistaturiList}"													
									selectedCode="#{opisZachList.searchDoc.registraturaId}" saveStateTree="true"
									withBtnClear="true" compType="4" styleAutoComp="" onClear="cmdChangeReg()" onComplete="cmdChangeReg()" />	
												
						</div>		
																
						<!--Валидност-->							 
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">
							<h:outputText value="#{labels['docu.valid']}" styleClass="form-label"/>
							 <p:selectCheckboxMenu id="validnost" value="#{opisZachList.searchDoc.validArr}" multiple="true">
								 <f:selectItems var="itemSc" itemLabel="#{itemSc.tekst}" itemValue="#{itemSc.code}"
								 value="#{systemData.getSysClassification(OmbConstants.CODE_CLASSIF_DOC_VALID, opisZachList.decodeDate, opisZachList.currentLang)}"/> 
							 </p:selectCheckboxMenu>												
						</div>
						
						<!--Статус на обработка-->						     
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">
							<h:outputText value="#{labels['docu.statusTitle']}" styleClass="form-label"/>
							<p:selectCheckboxMenu id="statusObr" value="#{opisZachList.searchDoc.statusArr}" multiple="true">
								<f:selectItems var="itemSc" itemLabel="#{itemSc.tekst}" itemValue="#{itemSc.code}"
								 value="#{systemData.getSysClassification(OmbConstants.CODE_CLASSIF_DOC_STATUS, opisZachList.decodeDate, opisZachList.currentLang)}" />
							</p:selectCheckboxMenu>
						</div>
						
						<!--Регистриран от потребител-->						 
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">
							<h:outputText value="#{labels['docList.userReg']}" styleClass="form-label"/>
							<ibg:selectOneModalA codeClassif="#{OmbConstants.CODE_CLASSIF_USERS}" 
									id="user"  dateClassif="#{opisZachList.decodeDate}" filtered="false" 													
									selectedCode="#{opisZachList.searchDoc.userReg}" saveStateTree="true"
									withBtnClear="true" compType="4" styleAutoComp="" />
														
						</div>
												    
						<!--Кореспондент -->
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4 ui-fluid ">												
							<h:outputText value="#{labels['docu.corespondent']}" styleClass="form-label"/>	
							<div class="ui-inputgroup">
											
								<p:inputText value="#{opisZachList.txtCorrespDoc}" id="coresp">	
									<p:ajax event="keyup" update="coresp" listener="#{opisZachList.actionChangeTxtCorresp}"/>   
								</p:inputText>							
								<!--  Разширено търсене на кореспондент -->
								<p:commandButton id="btnCorrS" styleClass="inputgroup-button"
									onmousemove="document.getElementById('formOpisZach:btnCorrS').focus();"
									icon="fas fa-list-ul" partialSubmit="true"
									process="formOpisZach:dpCorrSearch"							
									update="formOpisZach:dpCorrSearch @this"
									oncomplete="PF('mCorrS').show();"
									title="#{labels['search.extendRef']}" />																							
							</div>
							<p:remoteCommand name="cmdSelectCorresp" 
											update="coresp"
											process="coresp @this"
											actionListener="#{opisZachList.actionSelectCorresp}" />																										    
						</div>
						
						<!--Период на дата на получаване-->							 
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">	
							<h:outputText value="#{labels['docList.periodDateRes']}" styleClass="form-label"/>
							<p:selectOneMenu id="idPerRes" value="#{opisZachList.periodRes}">
								<f:selectItem value="#{null}" itemValue="#{null}"/>
								<f:selectItems  value="#{systemData.getSysClassification(OmbConstants.CODE_CLASSIF_PERIOD_NOFUTURE, now, opisZachList.currentLang)}" 
								  var="clPer" itemLabel="#{clPer.tekst}" itemValue="#{clPer.code}" />
								<p:ajax event="change" update="idPerRes dateOtRes dateDoRes" listener="#{opisZachList.changePeriodRes}"/>   
							 </p:selectOneMenu>
						</div>
													
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-2  ui-fluid">	
							<h:outputText value="#{ui_labels['general.dataOt']}" styleClass="form-label"/>
							<p:datePicker id="dateOtRes" pattern="dd.MM.yyyy" mask="true"  showIcon="true" locale="bg"  
								value="#{opisZachList.searchDoc.receiveDateFrom}" styleClass="form-control" >
								<p:ajax event="change" update="idPerRes" listener="#{opisZachList.changeDateRes}"/>
								<p:ajax event="dateSelect" update="idPerRes" listener="#{opisZachList.changeDateRes}"/>      
							</p:datePicker>
						</div>
													
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-2  ui-fluid">
							<h:outputText value="#{ui_labels['general.dataDo']}" styleClass="form-label"/>
							<p:datePicker id="dateDoRes" pattern="dd.MM.yyyy" mask="true" showIcon="true"  locale="bg" 
								value="#{opisZachList.searchDoc.receiveDateTo}" styleClass="form-control" >
								<p:ajax event="change" update="idPerRes" listener="#{opisZachList.changeDateRes}"/>   
								<p:ajax event="dateSelect" update="idPerRes" listener="#{opisZachList.changeDateRes}"/>   
							</p:datePicker>													    
						</div>
						
						<!--Получен чрез-->								 
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">
							<h:outputText value="#{labels['docu.receiveBy']}" styleClass="form-label"/>
							<p:selectCheckboxMenu id="receiveBy" value="#{opisZachList.searchDoc.receiveMethodArr}" multiple="true">
								<f:selectItems  value="#{systemData.getSysClassification(OmbConstants.CODE_CLASSIF_DVIJ_METHOD, opisZachList.decodeDate, opisZachList.currentLang)}"
									 var="itemSc" itemLabel="#{itemSc.tekst}" itemValue="#{itemSc.code}"/>
							</p:selectCheckboxMenu>													
						</div>
						
						<!--Период на дата на очакване на отговор-->							 
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">	
							<h:outputText value="#{labels['docList.periodDateResAns']}" styleClass="form-label"/>
							<p:selectOneMenu id="idPerAns" value="#{opisZachList.periodAnswer}">
								<f:selectItem value="#{null}" itemValue="#{null}"/>
								<f:selectItems  value="#{systemData.getSysClassification(OmbConstants.CODE_CLASSIF_PERIOD_NOFUTURE, now, opisZachList.currentLang)}" 
								     var="clPer" itemLabel="#{clPer.tekst}" itemValue="#{clPer.code}" />
								<p:ajax event="change" update="idPerAns dateOtAns dateDoAns" listener="#{opisZachList.changePeriodAnswer}"/>   
							 </p:selectOneMenu>
						</div>
													
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-2  ui-fluid">	
							<h:outputText value="#{ui_labels['general.dataOt']}" styleClass="form-label"/>
							<p:datePicker id="dateOtAns" pattern="dd.MM.yyyy" mask="true"  showIcon="true" locale="bg"  
								value="#{opisZachList.searchDoc.waitAnswerDateFrom}" styleClass="form-control" >
								<p:ajax event="change" update="idPerAns" listener="#{opisZachList.changeDateAnswer}"/>
								<p:ajax event="dateSelect" update="idPerAns" listener="#{opisZachList.changeDateAnswer}"/>      
							</p:datePicker>
						</div>
													
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-2  ui-fluid">
							<h:outputText value="#{ui_labels['general.dataDo']}" styleClass="form-label"/>
							<p:datePicker id="dateDoAns" pattern="dd.MM.yyyy" mask="true" showIcon="true" locale="bg" 
								value="#{opisZachList.searchDoc.waitAnswerDateTo}"  styleClass="form-control" >
								<p:ajax event="change" update="idPerAns" listener="#{opisZachList.changeDateAnswer}"/>   
								<p:ajax event="dateSelect" update="idPerAns" listener="#{opisZachList.changeDateAnswer}"/>   
							</p:datePicker>
						</div>
						
						<!--Документи с поставена задача за -->							
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">
							<h:outputText value="#{labels['docList.docTaskAssign']}" styleClass="form-label"/>
							<ibg:selectManyModalA  compType="2" maxResults="50" codeClassif="#{OmbConstants.CODE_CLASSIF_ADMIN_STR_REPORTS}" 
								id="taskAssign" dateClassif="#{opisZachList.decodeDate}" filtered="false"
								selectedCodes="#{opisZachList.searchDoc.taskReferentList}" saveStateTree="true"
								selectedClassifs="#{opisZachList.docsTaskAssignClassif}"
								withBtnClear="true"   styleAutoComp="width:100%;" />
						</div>
																			
						<!--Период на дата на поставяне-->													
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">	
							<h:outputText value="#{labels['docList.periodDatAssign']}" styleClass="form-label"/>
							<p:selectOneMenu id="idPerAssign" value="#{opisZachList.periodAssign}">
								 <f:selectItem value="#{null}" itemValue="#{null}"/>
								 <f:selectItems  value="#{systemData.getSysClassification(OmbConstants.CODE_CLASSIF_PERIOD_NOFUTURE, now, opisZachList.currentLang)}" 
								     var="clPer" itemLabel="#{clPer.tekst}" itemValue="#{clPer.code}" />
								 <p:ajax event="change" update="idPerAssign dateOtAssign dateDoAssign" listener="#{opisZachList.changePeriodAssign}"/>   
							</p:selectOneMenu>
						</div>
													
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-2  ui-fluid">	
							<h:outputText value="#{ui_labels['general.dataOt']}" styleClass="form-label"/>
							<p:datePicker id="dateOtAssign" pattern="dd.MM.yyyy" mask="true"  showIcon="true" locale="bg"  
								value="#{opisZachList.searchDoc.taskDateFrom}" styleClass="form-control" >
								<p:ajax event="change" update="idPerAssign" listener="#{opisZachList.changeDateAssign}"/>
								<p:ajax event="dateSelect" update="idPerAssign" listener="#{opisZachList.changeDateAssign}"/>      
							</p:datePicker>
						</div>
													
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-2  ui-fluid">
							<h:outputText value="#{ui_labels['general.dataDo']}" styleClass="form-label"/>
							<p:datePicker id="dateDoAssign" pattern="dd.MM.yyyy" mask="true" showIcon="true"  locale="bg" 
								value="#{opisZachList.searchDoc.taskDateTo}" styleClass="form-control" >
								<p:ajax event="change" update="idPerAssign" listener="#{opisZachList.changeDateAssign}"/>   
								<p:ajax event="dateSelect" update="idPerAssign" listener="#{opisZachList.changeDateAssign}"/>   
							</p:datePicker>												    
						</div>
						
						<!--Служител-->						
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">
							<h:outputText value="#{labels['docList.employee']}" styleClass="form-label"/>
							<ibg:selectOneModalA codeClassif="#{OmbConstants.CODE_CLASSIF_ADMIN_STR_REPORTS}" 
								id="employee" dateClassif="#{opisZachList.decodeDate}" filtered="false" 														
								selectedCode="#{opisZachList.searchDoc.docReferent}" saveStateTree="true"
								withBtnClear="true" compType="2" styleAutoComp="" />	
						</div>
						
						<!--Който е-->							
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-3 p-xl-4  ui-fluid">
							<h:outputText value="#{labels['docList.whichIs']}" styleClass="form-label"/>	
							<p:selectManyCheckbox value="#{opisZachList.searchDoc.docReferentRoles}" id="roles"	immediate="true">
								<f:selectItems  var="itemSc" itemLabel="#{itemSc.tekst}" itemValue="#{itemSc.code}"
								value="#{systemData.getSysClassification(OmbConstants.CODE_CLASSIF_DOC_REF_ROLE, opisZachList.decodeDate, opisZachList.currentLang)}" />
							</p:selectManyCheckbox>
						</div> 
						
						<!--GUID-->						
						<div  class="p-col-12 p-sm-12 p-md-6 p-lg-2 p-xl-2  ui-fluid">
							<h:outputText value="#{labels['registratura.guid']}" styleClass="form-label"/>
							<p:inputText value="#{opisZachList.searchDoc.guid}" id="guid"/>	
						</div>
						
						<!--Спешен-->						     
						<div class="p-col-12 p-sm-12 p-md-6 p-lg-2 p-xl-2  ui-fluid">
							<h:outputText value="#{labels['docList.urgent']}" styleClass="form-label"/>
							<p:selectCheckboxMenu id="urgent" value="#{opisZachList.searchDoc.urgentArr}" multiple="true">
								<f:selectItems var="itemSc" itemLabel="#{itemSc.tekst}" itemValue="#{itemSc.code}"
								 value="#{systemData.getSysClassification(OmbConstants.CODE_CLASSIF_URGENT, opisZachList.decodeDate, opisZachList.currentLang)}" />
							</p:selectCheckboxMenu>
						</div>
					</div>
					
					
				</div>
			</div>
				
			</h:panelGroup>	
	                
	                <div class="filter-buttons">
									
						<p:commandButton icon="fas fa-search" value="#{ui_labels['general.search']}"							    
							id="btnSearchDoc" update="panelSelDocs" partialSubmit="true"  style="font-size: 10pt;" 
							process="@this formOpisZach" actionListener="#{opisZachList.actionSearchInModal}"
							title="#{ui_labels['general.titleSearch']}" styleClass="p-mr-3" /> 
							<p:defaultCommand target="btnSearchDoc"/>
							 
							
						<p:commandButton icon="fas fa-search" value="#{ui_labels['general.searchFullText']}"  rendered="false"
										 id="btnSearchFullTextDoc" update="panelSelDocs" partialSubmit="true"  style="font-size: 10pt;" 
										 process="@this formOpisZach" actionListener="#{opisZachList.actionSearchFullTextInModal}"
										 title="#{ui_labels['general.titleSearchFulltext']}"  styleClass="p-mr-3" />
						
						<p:commandButton icon="fas fa-eraser"  value="#{ui_labels['general.clear']}"
							id="btnClear" update="panelSelDocs panelFilter" partialSubmit="true"  style="font-size: 10pt;" 
							process="@this formOpisZach"  actionListener="#{opisZachList.actionClear}"
							title="#{ui_labels['general.titleClear']}" styleClass="ui-button-warning" /> 
					</div>		
				
				<h:panelGroup  layout="block"  styleClass="margin-top"  rendered="#{opisZachList.docsList == null}">
				     <div  class="p-grid" >
				   
				   
		                  	   
		                       <div class="p-col-10 p-sm-10 p-md-10 p-lg-10 p-xl-10  ui-fluid" style="text-align: right;" >
		                     		                        
		                           <h:outputText value=" " />
		                       </div> 
		                       
		                       <div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" style="text-align: left;">
		                        <h:panelGroup rendered="false">		                       		                            
								<p:commandButton icon="fas fa-eraser" value="#{labels['opis.kamSpisak']}" 
									   partialSubmit="true" process="@this" update="formOpisZach"  styleClass="btn-normal" style="font-size: 10pt;width:85%" rendered="#{opisZachList.docsSelList != null and opisZachList.docsSelList.rowCount > 0}"
									    >
									<p:ajax event="click" listener="#{opisZachList.handleCloseDialogSelDocs}" oncomplete="PF('modalSelDocs').hide();"  />  
							     </p:commandButton>		   
							  	
							  								
			         		     <p:commandButton icon="fas fa-eraser" value="#{labels['opis.close']}" 
									   partialSubmit="true" process="@this" update="formOpisZach"  styleClass="btn-normal" style="font-size: 10pt;width:60%" rendered="#{opisZachList.docsSelList == null or  opisZachList.docsSelList.rowCount == 0}"
									  >
									<p:ajax event="click" listener="#{opisZachList.handleCloseDialogSelDocs}" oncomplete="PF('modalSelDocs').hide();"  />    
								 </p:commandButton>	  
			         		     </h:panelGroup>
			         		    
			         		    </div> 
			         		   		  						
							 
						</div>
				</h:panelGroup>		
        	 			
			  <h:panelGroup id="panelTableModal" layout="block"  styleClass="margin-top"  rendered="#{opisZachList.docsList != null}">
				   <h:panelGroup id="panelTblToolbar">
					
						<div  class="p-grid" >
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid">
								<h:outputText value="#{labels['opis.brNovi']} #{opisZachList.docsList.rowCount}" styleClass="form-label" rendered="#{opisZachList.docsList != null}"/>
							</div>
							
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							   <h:panelGroup   rendered="#{opisZachList.docSelectedAllModal.size() > 0}">
									<span class="ui-separator" style="padding-right: 5px;" >
										<span class="fas fa-ellipsis-v" />
									</span>
								
									<h:outputText value="#{labels['opis.brIzbr']} #{opisZachList.docSelectedAllModal.size()}"  styleClass="form-label" id="brSelDocs"/>
								</h:panelGroup>
							</div>		
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
							 <h:panelGroup   rendered="#{opisZachList.docSelectedAllModal.size() > 0}">
							   <p:commandButton icon="fas fa-eraser" value="#{labels['opis.razmAll']}" 
									 update="panelSelDocs " partialSubmit="true"   
									process="@this  panelTableModal" actionListener="#{opisZachList.actionRazmModal}"
									styleClass="ui-button-warning" style="width:90%" />
							  </h:panelGroup>
							  	 
						    </div>	
						   <div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" >
						      <h:outputText value="" />
						   </div>
						   
						   		                       
	                       
	                          <div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" style="text-align: right;" >
	                               
		                           <p:commandButton icon="fas fa-plus" value="#{labels['opis.addSpisak']}"  rendered="#{opisZachList.docsList != null and opisZachList.docsList.rowCount > 0 and opisZachList.docSelectedAllModal.size()== 0}"
									   partialSubmit="true" process="@this" update="formOpisZach"  style="font-size: 10pt;width:78%"  styleClass="ui-button-success"
									    >
									   <p:confirm header="#{ui_labels['general.comfirmation']}" message="#{labels['opis.messPotvAllBack']}" icon="fas fa-exclamation-triangle" />
									   <p:ajax event="click" listener="#{opisZachList.handleSelDocsOKAll}" oncomplete="PF('modalSelDocs').hide();"   />  
									</p:commandButton>   
		                            
                                   <p:commandButton icon="fas fa-plus" value="#{labels['opis.addSpisak']}"  rendered="#{opisZachList.docSelectedAllModal.size()> 0}"
									   partialSubmit="true" process="@this" update="formOpisZach"  style="font-size: 10pt;width:78%"  styleClass="ui-button-success"
									    >
									  <p:ajax event="click" listener="#{opisZachList.handleSelDocsOK}" oncomplete="PF('modalSelDocs').hide();"  />  
									</p:commandButton>    
		                        
		                       
		                       </div> 
		                       <div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2  ui-fluid" style="text-align: left;">
		                         <h:panelGroup rendered="false">		                          	  
								<p:commandButton icon="fas fa-eraser" value="#{labels['opis.kamSpisak']}" 
									   partialSubmit="true" process="@this" update="formOpisZach"  styleClass="btn-normal" style="font-size: 10pt;width:85%" rendered="#{opisZachList.docsSelList != null and opisZachList.docsSelList.rowCount > 0 }"
									  >
									 <p:ajax event="click" listener="#{opisZachList.handleCloseDialogSelDocs}" oncomplete="PF('modalSelDocs').hide();"  />    
							    </p:commandButton>		   
							  								
			         		      <p:commandButton icon="fas fa-eraser" value="#{labels['opis.close']}" 
									   partialSubmit="true" process="@this" update="formOpisZach"  styleClass="btn-normal" style="font-size: 10pt;width:60%" rendered="#{opisZachList.docsSelList == null or opisZachList.docsSelList.rowCount == 0}"
									   >
								     <p:ajax event="click" listener="#{opisZachList.handleCloseDialogSelDocs}" oncomplete="PF('modalSelDocs').hide();"  />    
								 </p:commandButton>	   
			         		    ,</h:panelGroup>
			         		    </div> 	
			         						 						
							
						</div>
					  </h:panelGroup>
					  
				       	<p:dataTable id="tblDocsOpis" var="row" value="#{opisZachList.docsList}" lazy="true"  widgetVar="rowS"
						rowIndexVar="idx" emptyMessage="#{ui_labels['general.norows']} (#{labels['opis.noAddDoc']})" rows="10" sortMode="single" reflow="true"
						paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
						rowsPerPageTemplate="5,10,15,20,25" paginatorPosition="bottom" paginatorAlwaysVisible="false" paginator="true"
                        rowSelectMode="checkbox"   selection="#{opisZachList.docSelectedTmpModal}" >

						<p:ajax event="toggleSelect"	 	 listener="#{opisZachList.onRowSelectAllModal}" process="@this" update="@form:panelTblToolbar"/>
												
						<p:ajax event="rowSelectCheckbox"  	 listener="#{opisZachList.onRowSelectModal}"   process="@this" update="@form:panelTblToolbar" />
						<p:ajax event="rowUnselectCheckbox"   listener="#{opisZachList.onRowUnselectModal}" process="@this" update="@form:panelTblToolbar" />
						<p:ajax event="page" listener="#{opisZachList.onPageUpdateSelectedModal}"   />
													
						<p:column selectionMode="multiple" exportable="false"  style="width:15px;text-align:center;"    />	
												
						<p:column width="25" exportable="false" headerText="#{ui_labels['general.No-symbol']}"  >
							<h:outputText value="#{idx + 1}" />
						</p:column>
								
						<p:column width="110" sortBy="#{row.A2}" headerText="#{labels['repDoc.regnom']}">
							<h:outputText value="#{row[2]}"  />								    
						</p:column>
						
						<p:column width="110" sortBy="#{row.A5}" headerText="#{labels['docu.docDate']}" >									  
							<h:outputText value="#{row[5]}">	
								<f:convertDateTime pattern="dd.MM.yyyy" timeZone="#{opisZachList.timeZone}"/>
							</h:outputText>							    
						</p:column>
						
						<p:column width="*" styleClass="col200" sortBy="#{row.A17}" headerText="#{labels['docu.otnosno']}">
							<h:outputText value="#{row[17]}"  />								    
						</p:column>
						
						<p:column width="*"  styleClass="col200" sortBy="#{row.A19}" headerText="#{labels['docList.idvaOtAvtori']}">
							<h:outputText rendered="#{row[6]==OmbConstants.CODE_ZNACHENIE_DOC_TYPE_IN}" value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_REFERENTS, row[19], opisZachList.currentLang, now)}"/>					    
							<h:outputText rendered="#{row[6]==OmbConstants.CODE_ZNACHENIE_DOC_TYPE_OWN or row[6]==OmbConstants.CODE_ZNACHENIE_DOC_TYPE_WRK}" value="#{systemData.decodeItems(OmbConstants.CODE_CLASSIF_ADMIN_STR_REPORTS, row[20], opisZachList.currentLang, now)}"/>
						</p:column>
						
						<p:column width="100" sortBy="#{row.A6}" headerText="#{labels['docu.type']}">
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DOC_TYPE, row[6], opisZachList.currentLang, now)}"/>					    
						</p:column>
						
						<p:column width="100" sortBy="#{row.A7}" headerText="#{labels['docu.vid']}">
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DOC_VID, row[7], opisZachList.currentLang, now)}"/>					    
						</p:column>
						
						<p:column width="160" sortBy="#{row.A16}" headerText="#{labels['docu.register']}">
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_REGISTRI, row[16], opisZachList.currentLang, now)}"/>					    
						</p:column>
								
									
					</p:dataTable>
                 
				</h:panelGroup>	
			 
				 <!--  ******************************************************************************************************************* --> 
				
							                        
			</p:outputPanel>
				<h:panelGroup id="dpCorrSearch">
					<p:dialog appendTo="@form"
						header="#{labels['opis.searchCoresp']}" minWidth="650"
						width="950" widgetVar="mCorrS" dynamic="true" id="modalCorrS" modal="true">
							<ibg:refCorrespSearch id="mCorrS1" myId="cCorr1"
								codeRef="#{opisZachList.searchDoc.codeRefCorresp}"
								searchTxt="#{opisZachList.txtCorrespDoc}"
								dateClassif="#{opisZachList.decodeDate}"
								modal="true" update="formOpisZach:coresp"
								onComplete="PF('mCorrS').hide();  cmdSelectCorresp()" />
		
					</p:dialog>
			   </h:panelGroup>
			  
	      </p:dialog>	
	      
	      <!--  ******************************************************************************************************************* --> 
	       <!--    Задаване на получател за избрани документи  (и номер на екзепляр за предаване - при работа с екземпляри - не се задава тук) -->
	       <!--  
							<p:commandButton icon="fas fa-eraser" value="Отваряне модален" 
								   partialSubmit="true" process="@this" update="zadPoluch formOpisZach"  
								    />   actionOpenModalPoluch
						-->  
	     <p:dialog appendTo="@form"  closeOnEscape="true"
		    header="#{labels['opis.zaglModalZadPoluch']}: " 
		    fitViewport="true"		
		    responsive="true"  
		    resizable="true"
		    
		    position="top" style="font-size: 10pt; margin-top:50px !important" width="90%"
			widgetVar="modalZadPoluch" dynamic="true" id="modalZadPoluch" 
			modal="true">
			
			  <p:ajax event="close" listener="#{opisZachList.handleCloseDialogZadPoluch}" process="@this" update="formOpisZach" onComplete = "PF('modalZadPoluch').hide();"   />
			  
			  <p:messages>
			        <p:autoUpdate />
			  </p:messages>
			  
			   <div class="p-grid ui-fluid" >
			   <div class="p-col-6 p-sm-6 p-md-6 p-lg-6 p-xl-6" >
			  <h:panelGroup  >
                              <h:outputText value="#{labels['opis.tipPoluch']}:"   style="font-weight: bold; " />
			       				 <p:selectOneRadio   value="#{opisZachList.tipPoluch}"  style="font-weight: bold;color:blue;" >                                                                
			                          <f:selectItem itemValue="1" itemLabel="#{labels['opis.otAdmStr']}"  />                 
			                          <f:selectItem itemValue="2" itemLabel="#{labels['opis.coresp']}"  />
			                          
			                          <p:ajax event="click" listener="#{opisZachList.actionTipPoluch}"  process="@this" partialSubmit="true"  update="poluch" />
			                          
			                     </p:selectOneRadio>
			  </h:panelGroup> 
			  </div>
	          </div>
	          <div class="p-grid ui-fluid p-align-end" >
	           <div class="p-col-6 p-sm-6 p-md-6 p-lg-6 p-xl-6  ui-fluid" >
	               <h:panelGroup  id="poluch" rendered="#{opisZachList.tipPoluch == 1 or opisZachList.tipPoluch == 2}" >
	            
	                   <!--    Предаден на - код от Адм. стр. -->
	                   <h:panelGroup rendered="#{opisZachList.tipPoluch == 1}">
							
							
								<h:outputText value="#{labels['opis.predNa']}" styleClass="form-label"/>
								 
								 <ibg:selectOneModalA  id="polAdm"
											update="@this"							
											codeClassif="#{OmbConstants.CODE_CLASSIF_ADMIN_STR_REPORTS}"	
											dateClassif="#{opisZachList.decodeDate}"		
											styleAutoComp="width:95%;"	
											selectedCode="#{opisZachList.codePredNa}"
											selectedText="#{opisZachList.namePredNa}"
											emptyMessage="#{labels['opis.AdmStrEmpty']}"
											saveStateTree="false" withBtnClear="true" compType="2" 
											 header="#{labels['opis.izbAdmStr']}" />
											 
											<p:message for="polAdm" display="tooltip" escape="false">
								      			<p:autoUpdate/>
							 	      		</p:message>								 
															
						
						</h:panelGroup> 	
						
						 <!--    Предадени на  кореспондент . -->
						<!-- трябва да се добави и компонента за търсене на корепоснденти?  -->
						 <h:panelGroup id="corPred" rendered="#{opisZachList.tipPoluch == 2}">	
																									
								<h:outputText value="#{labels['opis.predNaCoresp']}" styleClass="form-label"/>	
								<div class="ui-inputgroup">
												
									<p:inputText value="#{opisZachList.txtCorrespPred}" id="corespPred">	
										<p:ajax event="keyup" update="corespPred" listener="#{opisZachList.actionChangeTxtCorrespPred}"/>   
									</p:inputText>
									<p:commandButton id="btnDelCorrespPred" value="x" style="font-weight: bold;font-size: 8pt; color:black; background-color: #0000;  " 
									  title="#{labels['opis.delCorresp']}" rendered="#{opisZachList.codeRefCorrespPred!=null or (opisZachList.txtCorrespPred!=null and opisZachList.txtCorrespPred!='') }" >
									   <p:ajax event="click"  listener="#{opisZachList.actionClearCorrespPred}"  update="formOpisZach:corespPred formOpisZach:corPred @this" />
									</p:commandButton>
												
									<!--  Разширено търсене на кореспондент -->
									<p:commandButton id="btnCorrSPred" styleClass="inputgroup-button"  
										onmousemove="document.getElementById('formOpisZach:btnCorrSPred').focus();"
										icon="fas fa-list-ul" partialSubmit="true"
										process="dpCorrPredSearch"							
										update="formOpisZach:corespPred formOpisZach:corPred  @this"
										oncomplete="PF('mCorrSPred').show();"
										title="" />																							
								</div>
								<p:remoteCommand name="cmdSelectCorrespPred" 
												update="formOpisZach:corespPred formOpisZach:corPred"
												process="formOpisZach:corespPred formOpisZach:corPred @this"
												actionListener="#{opisZachList.actionSelectCorrespPred}" />	
							 
							 </h:panelGroup> 																													    
															                  
		                </h:panelGroup> 
		                </div>
		                
		               
						  <!--Метод на предаване  на ръка -->														
							<div class="p-col-2 p-sm-2 p-md-2 p-lg-2 p-xl-2 ui-fluid">
							  <h:outputText value="#{labels['opis.metodPred']}" styleClass="form-label"/>
							  <div class="ui-inputgroup">
									<p:inputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DVIJ_METHOD, opisZachList.nachinPred, opisZachList.currentLang, now)}"  readonly="true"/>
							  </div>		
							</div>
							
							<!-- Номер на екземпляр за предаване -->
							<!--  														
							<div class="p-col-1 p-sm-1 p-md-1 p-lg-1 p-xl-1 ui-fluid" >
							<h:panelGroup rendered="#{opisZachList.nastrWithEkz}">
							  <h:outputText value="#{labels['opis.nomEkz']}" styleClass="form-label req"/>
							  <div class="ui-inputgroup">
									<p:inputText value="#{opisZachList.nomEkzPred}" maxlength="4" >
									    <p:keyFilter regEx="/[\d]/"/> 
									    <p:ajax event="change"   />
									</p:inputText>
							  </div>	
							  </h:panelGroup>	 
							</div>
							-->   <!--  <f:convertNumber pattern = "##0" maxIntegerDigits="4" /> -->
						
		           </div>
	             		  
	      
	      	   <div class="p-grid">
					<h:panelGroup id="zadPoluch" >		
							 <div   class="p-col-12 ui-fluid">
	                           <h:outputText value=" " />
	                         </div>
	                         <h:panelGroup rendered="false">
								<p:commandButton icon="fas fa-eraser" value="#{labels['opis.close']}" 
									   partialSubmit="true" process="@this" update="zadPoluch formOpisZach"  
									  >
								   <p:ajax event="click" listener="#{opisZachList.handleCloseDialogZadPoluch}" oncomplete="PF('modalZadPoluch').hide();"  />    	   
								</p:commandButton>	   
						      </h:panelGroup>
					
					</h:panelGroup>			
			    </div>   
			    
			     <!-- Избор на кореспондент  -->  
			        <h:panelGroup id="dpCorrPredSearch">
						<p:dialog appendTo="@form"   position="top"
							fitViewport="true"		
						    responsive="true"  
						    resizable="true"
								header="#{labels['docu.titleExtSrchCoresp']}"  minWidth="650" 
								width="950" widgetVar="mCorrSPred" dynamic="true" id="modalCorrSPred" modal="true">
									<ibg:refCorrespSearch id="mCorrS1Pred" myId="cCorr2"
										codeRef="#{opisZachList.codeRefCorrespPred}"
										searchTxt="#{opisZachList.txtCorrespPred}"
										dateClassif="#{opisZachList.decodeDate}"
										modal="true" update="formOpisZach:corespPred"
										onComplete="PF('mCorrSPred').hide();  cmdSelectCorrespPred()" />
			
						</p:dialog>
					</h:panelGroup>                    
					
		</p:dialog>  
	      	  
         <!--  **************************************************************************************************************************  -->     
          
          <!--   Избрани  документи с назначени получатели (и номера на екземпляри за предаване - при работа с екземпляри) за формиране на опис -->
           <!--  ******************************************************************************************************************* --> 
          <p:dialog appendTo="@form"  closeOnEscape="true"
		    header="#{opisZachList.zaglModal} " 
		    fitViewport="true"		
		    responsive="true"  
		    resizable="true"
		    
		    position="top" style="font-size: 10pt; margin-top:50px !important" 
			widgetVar="modalFormOpis" dynamic="true" id="modalFormOpisIdM" 
			modal="true">
			
			  <p:ajax event="close" listener="#{opisZachList.handleCloseDialogFormOpis}" process="@this" update="formOpisZach"  />
			  
			  <p:messages>
			     <p:autoUpdate />
			  </p:messages>
			  
			  
			  <h:panelGroup  >
                              <h:outputText value="#{labels['opis.sort']}:"   style="font-weight: bold; " />
			       				 <p:selectOneRadio  id="wh_data"  value="#{opisZachList.vidSort}"  style="font-weight: bold;color:blue;" >                                                                
			                          <f:selectItem itemValue="0" itemLabel="#{labels['opis.sortPoluch1']}"  />                 
			                          <f:selectItem itemValue="1" itemLabel="#{labels['opis.sortTipDoc1']}"  />
			                          <f:selectItem itemValue="2" itemLabel="#{labels['opis.sortVidDoc1']}"   />
			                          <p:ajax event="click" listener="#{opisZachList.actionSort}"  process="@this" partialSubmit="true"  update="panelT tblDocs" />
			                          
			                     </p:selectOneRadio>
			  </h:panelGroup> 
			   
			  <div class="filter-buttons">
			  <h:panelGroup id="zach" >
			  <h:panelGroup rendered="#{!opisZachList.prClearLists}">
			     <p:commandButton icon="fas fa-plus" value="#{labels['opis.zachisl']}"
					id="btnZachislDoc" update="zach panelT tblDocs" partialSubmit="true"  style="font-size: 10pt;" 
					 process="@this " actionListener="#{opisZachList.actionZachislDocs}"  styleClass="ui-button-success"
					 title="#{labels['opis.helpZachisl']}"  />
			  </h:panelGroup>
			     <h:panelGroup rendered="#{opisZachList.prClearLists }" >
			      <h:outputText value="#{labels['opis.exportv']}: "  />
			          
						<h:commandLink  actionListener="#{opisZachList.htmlExport}"  target="_blank" style="color:blue;vertical-align: middle;font-size:10pt;" styleClass="p-mr-3">
						     <!--  <h:graphicImage library="images" name="html.png"  /> -->  <!--  style="font-size:10pt;"  -->
						   <h:outputText value="Html" />
						     <i class="fab fa-html5" />
				             <!--  <i class="fas fa-print" />  -->
						</h:commandLink>
												
						<h:commandLink  actionListener="#{opisZachList.wordExport}"  target="_blank" style="color:blue;vertical-align: middle;font-size:10pt;"  styleClass="p-mr-3">
						    <!--   <h:graphicImage library="images" name="word.png"  /> -->  
				       		<h:outputText value="Word" />
				       		 <i class="fas fa-file-word" />
						</h:commandLink>
						
						<h:commandLink  actionListener="#{opisZachList.excelExport}" target="_blank" style="color:blue;vertical-align: baseline; font-size:10pt;"  styleClass="p-mr-3">
				       	  <!--   <h:graphicImage library="images" name="excel.png"  />   --> 
					       <h:outputText value="Excel"  />
					        <i class="fas fa-file-excel" />
						</h:commandLink> 
				  </h:panelGroup>
				</h:panelGroup>  		
			  </div>
			
			  <h:panelGroup id="panelT" layout="block"  styleClass="margin-top"  >
									  
				       	<p:dataTable id="tblDocs" var="row" value="#{opisZachList.docSelectedAllMOpisT}" lazy="true"  
						rowIndexVar="idx" emptyMessage="#{ui_labels['general.norows']}" rows="10" sortMode="single" reflow="true"
						style="font-size: 10pt;"  editable="true" editMode="row"
						paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
						rowsPerPageTemplate="5,10,15,20,25" paginatorPosition="bottom" paginatorAlwaysVisible="true" paginator="true"
                         >

						
						<p:column width="20" exportable="false" headerText="#{ui_labels['general.No-symbol']}" >
							<h:outputText value="#{idx + 1}" />
						</p:column>

						<p:column width="250" headerText="#{labels['opis.polu']}">    <!--  Получател -->
							<h:outputText value="#{row[11]}" />
						</p:column>
						<p:column width="70"  headerText="#{labels['opis.datPred']}" style="text-align:center;">   <!-- Дата на предаване -->
							<h:outputText value="#{row[8]}" >
							
								<f:convertDateTime pattern="dd.MM.yyyy" timeZone="#{opisZachList.timeZone}"/>
							</h:outputText>
						</p:column>
                        <p:column width="100"  headerText="#{labels['opis.regN']}">   <!-- Рег. номер  -->
							<h:outputText value="#{row[2]}" />
						</p:column>
						<p:column width="80"  headerText="#{labels['docu.docDate']}" style="text-align:center;">									  
							<h:outputText value="#{row[5]}">	
								<f:convertDateTime pattern="dd.MM.yyyy" timeZone="#{opisZachList.timeZone}"/>
							</h:outputText>							    
						</p:column>
						
						<p:column width="*" styleClass="col200"  headerText="#{labels['docu.otnosno']}">
							<h:outputText value="#{row[17]}"  />								    
						</p:column>
						
						 <p:column width="90"  headerText="#{labels['opis.tipD']}">           <!--  Тип документ -->
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DOC_TYPE, row[6], opisZachList.currentLang, now)}" />
						</p:column>
						 <p:column width="220"  headerText="#{labels['opis.vidD']}">           <!--  Вид документ -->
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_DOC_VID, row[7], opisZachList.currentLang, now)}" />
						</p:column>
						<p:column width="160"  headerText="#{labels['docu.register']}" rendered="false">
							<h:outputText value="#{systemData.decodeItem(OmbConstants.CODE_CLASSIF_REGISTRI, row[16], opisZachList.currentLang, now)}"/>					    
						</p:column>
						
					  		<!-- Екземпляр -->
						<p:column headerText="#{labels['docDvij.ekz']}" style="text-align: center" width="30" rendered="#{opisZachList.nastrWithEkz}">
							<p:cellEditor>
				                <f:facet name="output">
									<h:outputText value="#{row[12]}" />
								</f:facet>
				                <f:facet name="input">
				                    <p:inputText value="#{row[12]}">
				                    	<p:keyFilter regEx="/[\d]/"/>  
				                    </p:inputText>
				                </f:facet>
				            </p:cellEditor>
						</p:column>
						
						<!-- Номер екз. само - след запис  -->
						<!-- 
						 <p:column width="50"  headerText="#{labels['opis.nomEkz']}" style="text-align:center;"   rendered="#{(!opisZachList.nastrWithEkz and opisZachList.prClearLists)}">   
							<h:outputText value="#{row[12]}" />
						</p:column>
						 -->
						 
						   <!--    Задаване актуализация за екземпляр  -->
						<p:column style="text-align: center" width="40" rendered="#{opisZachList.nastrWithEkz and !opisZachList.prClearLists}">
							<p:rowEditor cancelTitle="#{ui_labels['general.cancel']}"
								saveTitle="#{ui_labels['general.save']}"
								editTitle="#{labels['opis.editEkz']}" />
						</p:column>
											
					</p:dataTable>
                 
				</h:panelGroup>	
			 
			 
			 	<div class="p-grid">
							
							 <div   class="p-col-12 ui-fluid">
	                           <h:outputText value=" " />
	                         </div>
	                       <h:panelGroup rendered="false">
								<p:commandButton icon="fas fa-eraser" value="#{labels['opis.close']}" 
									   partialSubmit="true" process="@this" update="formOpisZach"  
									  >
								   <p:ajax event="click" listener="#{opisZachList.handleCloseDialogFormOpis}" oncomplete="PF('modalFormOpis').hide();"  />    	   
								 </p:commandButton>   	
						   </h:panelGroup>		    
								
			    </div>               <!-- styleClass="ui-button-secondary"  styleClass="ui-button-success" -->
					
		</p:dialog>
	      <!--  ******************************************************************************************************************* --> 
	          
		</h:form>
        
    </ui:define>

</ui:composition>